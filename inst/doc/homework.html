<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yuxin Zhang" />

<meta name="date" content="2021-12-16" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Yuxin Zhang</h4>
<h4 class="date">2021-12-16</h4>



<div id="homework-for-09.16" class="section level2">
<h2>homework for 09.16</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>texts:</p>
<p>Linear structure for covariance matrix <span class="math inline">\(\Sigma\)</span> means that <span class="math inline">\(\Sigma\)</span> can be represented as a linear combination of pre-specified symmetric <span class="math inline">\(p\times p\)</span> matrices <span class="math inline">\(\left(A_1,...,A_K\right)\)</span> with fixed and finite <span class="math inline">\(K\)</span>. That is, <span class="math display">\[\Sigma=\theta_1 A_1+\theta_2 A_2+...+\theta_K A_K,\]</span> where <span class="math inline">\(\left\{\theta_j,j=1,...,K\right\}\)</span> are unknown parameters. Here <span class="math inline">\(A_1,...,A_K\)</span> are a set of basis matrices, and they are assumed to be linearly independent. For example, Anderson (1973) provided various covariance matrices with different linear structures. In particular, the author showed that the covariance for <span class="math inline">\(x=\sum_{k=1}^{K}U_k\zeta_k+e\)</span> satisfies the linear covariance structure, where <span class="math inline">\(\zeta_k\sim N(0,\theta_0I_p)\)</span>, <span class="math inline">\(e\sim N(0,\theta_0I_p)\)</span>,<span class="math inline">\(\zeta_1,...,\zeta_K\)</span>, <span class="math inline">\(e\)</span> are independent and <span class="math inline">\(I_p\)</span> is the identity matrix. Several other useful linear covariance structures are given in Section 2.4.</p>
<p>texts cite from: Zheng Shurong,,Chen Zhao,,Cui Hengjian &amp; Li Runze.(2019).HYPOTHESIS TESTING ON LINEAR STRUCTURES OF HIGH DIMENSIONAL COVARIANCE MATRIX.. Annals of statistics(6), <a href="doi:10.1214/18-AOS1779" class="uri">doi:10.1214/18-AOS1779</a>.</p>
<p><br />
figures:</p>
<p>An exercise in Probability: <span class="math inline">\(X\sim N(0,4)\)</span>, <span class="math inline">\(Y\sim N(0,4)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, <span class="math inline">\(X+Y\sim?\)</span></p>
<p>Theoretically, <span class="math inline">\(X+Y\sim N(0,8)\)</span>. We established a function <span class="math inline">\(Z\)</span> and conducted 10,000 simulations to investigate whether the simulated distribution density function is similar to the real distribution density function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>Z&lt;-<span class="cf">function</span>(n){</span>
<span id="cb1-2"><a href="#cb1-2"></a>x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>,<span class="fl">0.01</span>) </span>
<span id="cb1-3"><a href="#cb1-3"></a>truth&lt;-<span class="kw">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)) </span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">plot</span>(<span class="kw">density</span>(<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)),<span class="dt">main=</span><span class="st">&quot;density estimate of the normal addition model&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>) </span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">lines</span>(x,truth,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>) </span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;true&quot;</span>,<span class="st">&quot;estimated&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-7"><a href="#cb1-7"></a>}</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">Z</span>(<span class="dv">1000</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><br />
tables:</p>
<p>In this part, we use function kable to show the data from R’s datasets. And then, we use package “gt” to process and beautify this table.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(xtable)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(gt)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(datasets)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">library</span>(knitr)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">data</span>(airquality)</span>
<span id="cb2-7"><a href="#cb2-7"></a>table&lt;-<span class="kw">kable</span>(airquality[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,])</span>
<span id="cb2-8"><a href="#cb2-8"></a>table</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Ozone</th>
<th align="right">Solar.R</th>
<th align="right">Wind</th>
<th align="right">Temp</th>
<th align="right">Month</th>
<th align="right">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">41</td>
<td align="right">190</td>
<td align="right">7.4</td>
<td align="right">67</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">118</td>
<td align="right">8.0</td>
<td align="right">72</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">149</td>
<td align="right">12.6</td>
<td align="right">74</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">313</td>
<td align="right">11.5</td>
<td align="right">62</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">14.3</td>
<td align="right">56</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="right">NA</td>
<td align="right">14.9</td>
<td align="right">66</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="right">299</td>
<td align="right">8.6</td>
<td align="right">65</td>
<td align="right">5</td>
<td align="right">7</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>gt_table&lt;-<span class="kw">gt</span>(<span class="dt">data=</span>airquality[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,])</span>
<span id="cb3-2"><a href="#cb3-2"></a>gt_table &lt;-</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">    </span>gt_table <span class="op">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">    </span><span class="kw">tab_header</span>(</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="dt">title=</span><span class="kw">md</span>(<span class="st">&quot;**New York Air Quality Measurements**&quot;</span>),</span>
<span id="cb3-6"><a href="#cb3-6"></a>        <span class="dt">subtitle=</span><span class="kw">md</span>(<span class="st">&quot;*The first seven days of May, 1973*&quot;</span>) </span>
<span id="cb3-7"><a href="#cb3-7"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="st">    </span><span class="kw">tab_source_note</span>(</span>
<span id="cb3-9"><a href="#cb3-9"></a>        <span class="dt">source_note=</span><span class="st">&quot;Source: The data were obtained from the New York State Department of Conservation (ozone data) and the National Weather Service (meteorological data).&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st">    </span><span class="kw">tab_source_note</span>(</span>
<span id="cb3-12"><a href="#cb3-12"></a>        <span class="dt">source_note=</span><span class="kw">md</span>(<span class="st">&quot;Reference: Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983) *Graphical Methods for Data Analysis*. Belmont, CA: Wadsworth.&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a>    ) </span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>gt_table</span></code></pre></div>
<div id="qhytxslnme" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qhytxslnme .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qhytxslnme .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qhytxslnme .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qhytxslnme .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qhytxslnme .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhytxslnme .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qhytxslnme .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qhytxslnme .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qhytxslnme .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qhytxslnme .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qhytxslnme .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qhytxslnme .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qhytxslnme .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qhytxslnme .gt_from_md > :first-child {
  margin-top: 0;
}

#qhytxslnme .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qhytxslnme .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qhytxslnme .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qhytxslnme .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhytxslnme .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qhytxslnme .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhytxslnme .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qhytxslnme .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qhytxslnme .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhytxslnme .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qhytxslnme .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qhytxslnme .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qhytxslnme .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qhytxslnme .gt_left {
  text-align: left;
}

#qhytxslnme .gt_center {
  text-align: center;
}

#qhytxslnme .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qhytxslnme .gt_font_normal {
  font-weight: normal;
}

#qhytxslnme .gt_font_bold {
  font-weight: bold;
}

#qhytxslnme .gt_font_italic {
  font-style: italic;
}

#qhytxslnme .gt_super {
  font-size: 65%;
}

#qhytxslnme .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="6" class="gt_heading gt_title gt_font_normal" style><strong>New York Air Quality Measurements</strong></th>
    </tr>
    <tr>
      <th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><em>The first seven days of May, 1973</em></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Ozone</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Solar.R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Wind</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Temp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Day</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">41</td>
<td class="gt_row gt_right">190</td>
<td class="gt_row gt_right">7.4</td>
<td class="gt_row gt_right">67</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_right">36</td>
<td class="gt_row gt_right">118</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">72</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">149</td>
<td class="gt_row gt_right">12.6</td>
<td class="gt_row gt_right">74</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td></tr>
    <tr><td class="gt_row gt_right">18</td>
<td class="gt_row gt_right">313</td>
<td class="gt_row gt_right">11.5</td>
<td class="gt_row gt_right">62</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">4</td></tr>
    <tr><td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">14.3</td>
<td class="gt_row gt_right">56</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">5</td></tr>
    <tr><td class="gt_row gt_right">28</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">14.9</td>
<td class="gt_row gt_right">66</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">6</td></tr>
    <tr><td class="gt_row gt_right">23</td>
<td class="gt_row gt_right">299</td>
<td class="gt_row gt_right">8.6</td>
<td class="gt_row gt_right">65</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">7</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="6">Source: The data were obtained from the New York State Department of Conservation (ozone data) and the National Weather Service (meteorological data).</td>
    </tr>
    <tr>
      <td class="gt_sourcenote" colspan="6">Reference: Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983) <em>Graphical Methods for Data Analysis</em>. Belmont, CA: Wadsworth.</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
<div id="homework-for-09.23" class="section level2">
<h2>homework for 09.23</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.4:<br />
Given the Rayleigh density, we can easily obtain the distribution function <span class="math inline">\(F(x)\)</span>: <span class="math display">\[F(x)=\int _0^x \frac{u}{\sigma^2}e^\frac{-u^2}{2\sigma^2}du=\int _0^x(-1)d(e^\frac{-u^2}{2\sigma^2})=-e^\frac{-u^2}{2\sigma^2}\mid_0^x=1-e^\frac{-x^2}{2\sigma^2}\]</span> Therefore, we can use the inverse transform method to generate random numbers from the Rayleigh distribution. Then, we need to obtain <span class="math inline">\(F_X^{-1}(U)\)</span>. <span class="math display">\[F(X)=1-e^\frac{-X^2}{2\sigma^2}=U,X&gt;0\]</span> <span class="math display">\[-ln(1-U)=\frac{X^2}{2\sigma^2}\]</span> <span class="math display">\[X=F_X^{-1}(U)=\sqrt{-2\sigma^2ln(1-U)}\]</span> The algorithm steps are as follow:<br />
step 1: Generate <span class="math inline">\(U\sim U(0,1)\)</span>.<br />
step 2: Return <span class="math inline">\(X=F_X^{-1}(U)\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>n&lt;-<span class="fl">1e3</span>;</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>rleigh&lt;-<span class="cf">function</span>(sigma){</span>
<span id="cb4-4"><a href="#cb4-4"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb4-5"><a href="#cb4-5"></a>x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb4-6"><a href="#cb4-6"></a>y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">hist</span>(x,<span class="dt">probability =</span> <span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">paste</span> (<span class="st">&quot;sigma=&quot;</span>,<span class="kw">as.character</span>(sigma),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">border=</span><span class="ot">NA</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">lines</span>(y,(y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb4-9"><a href="#cb4-9"></a>}</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="kw">rleigh</span>(<span class="dv">4</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="kw">rleigh</span>(<span class="dv">5</span>)</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="kw">rleigh</span>(<span class="dv">10</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="kw">rleigh</span>(<span class="dv">15</span>)</span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="kw">rleigh</span>(<span class="dv">20</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6AGY6OgA6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOmZmkLZmkNtmtrZmtttmtv+QOgCQOjqQOmaQZjqQZmaQtpCQ2/+2ZgC2Zjq229u22/+2/7a2///T09PbkDrbkGbbtmbbtrbb27bb/7bb/9vb////tmb/25D/27b//7b//9v///95oPD1AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALP0lEQVR4nO2di5rathaFxSRT3KYJTGhPB1LacZoMNE07dmy//6sdyxdutll7C+sgTtf6MjME7CXp196SbAM2BXVW5toVCF0EBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQFJA+eruWbhpYqb6eoj9E2PM5MmTeVHEdst0YV5/ap4YH1C+8gpoq6WjMf+2NuWW+Wr6z+r+pX5q/BQru9gBkFSKYNArm0+i0j6NZvt+wIDytTHv6oqlkflxcfecRt+tzeSXhZksq3A0rw86NV+9ilSAdP7ZvMywR1/mP/1ht0zMsvqphAFtzbL8Z8vI5vcvibFl3H1Ko8ljtrDPTV/s81tTaVYkk991gHT+afQuj+VZpqx8jXJbAZrJAb16fKn2tDvZv2lJwPrW4f7Xbz+Yfdhn81mqBaTxt9pVfnxzF0BZFYZ2T7vjaRnZYvLz17l9re6Ebf2yQjp/JSCtee6QYkXxdW2mQ51gjezjZtNyCrPSjdIK/0oKQFrzBpBqkC43LYf1No2/mNMypmVIHqWANsVU/mXl81g+kWkrXwFSTvN2Inhbp2wSmbeLkzT+WMbw+mjUVAJS+v8ZHU2aI1e+HplcForHDv7k1d/FXAOonCGfv839rQK9+ruaqyKoDG/zxmMAefV3NOfRPBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREFANKJsrTmI66Ib92wjaGs2JXr1u1v8gxcoyll7KuGn/FlBieyB77+1sWHD+Rjj8tmOQ7Fxkff3IVI/EVVH477XZ+PU3xUYDSGteoXLYEzofdIDX+XVjNhtZCU0E2dgUB2jVAGEHFEH57zrAApKVYDdqLoea4+uXZ/cxmgY4+JcNkIeQm78CkKJz232M0L6R2r9sgCb7XfwVgLL3n+e2B6RX1RpA4gbI/XcpYDQ94FZ/YQscB+myAH9HKU0DfPvLWtBsk0yzuXiZ5QDIwV8RomL/fYRuNsIuqLfJPzxtp+kbxSCtA+TirwkhN38FoHKQi2eaaVKZAk7+igKk/k0pDhH06+eHJ20PKFLAyV8TQU7+oha0Y5C5//tB+rYbo+iAwslfC8jNX1SC2yymBqT0V8wyOucmhY0a0Fa3jlADEvrvGrBRAnKqvwJQJg7PwwIUg6iTv2KpqPPf7ADhEpwONTbyMa5w8dcDcqq/KEabLWLNubi2AEUK6Px3gMQFCP2bFNYDygaOZZLKb/820OMC5ICk/m2dFGOEi/8OkD0mBjpbhXxVdczpAsMhgoT+x4P0xfMkqL+ohGaDsgseP3QGuia1TzN8V4BiEHLyVwxCbv5iQCXqeNldibY98P2lDXD1lxbg7I/7eH8stuyZCtKoN4e19df6qwFJ/U8HaUEJBxGUiE9ZGjH/RlL/TgOEBWjrfwgIlLAfg/oWogOzgCKFi8v8xSHk6g9LcJrFFCl8Vtj/sgIE/rCEs68OzQJHDbigBQJ/W4DqGqLWHzWhfq061usuRjuzgNmd0TosDkO6xL/w7V+cvUxcvRTb4S1fdd8e0T/L7MrpL66rC/1hCT797WsDkXh+p/r65+5/5+Tkf/ozrr+pf+3/nK0LKqDzwsiAev1HBNTjPy6g3p3+VRE0rzNR/HlFLSAXfw0gvb8O0LD6F1paQE7+CkAO/iMBGlhojQbonP8YgIb9RwKkTm6lbsFfFEHfe2rALfifj96BhdZougH/iw42/w0iICACAiIgIAICIiAgB0CJ5w+lhOWvB5Q9PHlb2QXorwdUHtnk3YuY4ykwfz2gZKp8s8Zt+xMQEFMMiIM0EKd5IC4UgQgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgNwBxfb2Lx6/PDIQ/wsiKJ7FHu/VF4r/BYDylfQjfrfsfwGgNPL37stw/C96F7j4U6I37O8MKF/Za9z+BolQ/DnNAxEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQkAhQvhJ/G3pst0yUX8Er9c8/RuZ16ZsuzOtPcvuLNC6gb+vqi+W3yrfIS/2/mP8U8eQpX03/8fwxhb1GTbFsPonKpioCTq/ELNNopu4DZwFA+dqYd3WL08j8uLh7TqPv1mbyy8JMllWsVzHfKPvpD7ulvUvB5FFUvM7fKjbLkpHlpG6rkwCgrVmW/2wDsvn9S2JsA+4+pdHkMVvY56Yv9vltfduGWdE29V0ey3pY61+CmTxtK0AeP0p2KAjo1eNL1WxbI/s3jaaFrXSdR3/99sPR7Sx22SVsgNa/DLNpERKgrIpxW1lbq9MGZIvJz1/n9rWjCLISNkDpX/Ip/UNKsaL4ujbToR62tbSP91trAen881W1erCbhjJIl/Uo54x2jPhiThtg472TYmUD8lg2ken8m29ADGmat7PM23o8SCLzdnEyRnwsE2R92Jd1BP0Znc494/jHbaaFtlBs5XWB8z/wd5EYUDn9Pn+b+/sEoG9/V8kjqMwb88ZjB/v2dxSP5oEICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIBqQNnc7ylw3/4e1UbQ1vi9TODb35sOUmzr+Z46vv39qAWU2B72dldqB38TyOjYjkHac50bVf31/iYsQOKtaxXeG7Axm0AINRFkY1+cABUgFVqdf1EB0sWoN9la5Ks6MKTX4ipAih7W+hehAdJ1bgtI0wCp/y6FK0BBELKVyN5/ntt6Sa/aGdsSBSBH/zBCyKUSpupgf/U3VYCGBSiZZnPBMq5NgRqQogFC/12dQgOUf3jaTtM34kF6o2yA1H83BoUGqBxE45limtcCcvMP4lRDE0G/fn548hlBTv5BhFA7Bpn7vx+k79nSA3LzDwmQch9TA/LUgNY/JEBb2TqlHUTr+isa4OgfAKFmkBaHf72PFtCQf1LxOH0/5s4/hBByO9RQA+r3z1fV0uh09A4QkOYO9YeAxA3o92+4neILEFA2cKw0VgoM+LcRtLv9+8kYFMIgdLYG3lMgjc53QAAh1NSg7OLHD52BFKeAIoR6/IfqtAkOUBkq8bK70h1KAXUDBvyHUvjA/+qE9sdiy56pZiAF1IAG/Dsp3OmA64fQQQSJ76RjjLaHB/yHUtgcALo2of0Y1LfQHUiBff3FIdTr30nhrv/VQ8hpFjsEdFEDBlL4CNCVCZ0tfjAFjhoweguO/H0UoKpM9bs6luwudodmseMad57oasC/k8K9/te9yloVHdvhs++OiP0psGuH6W9QR0P+AylcqMw9q77s05tJZ3cy9a/dw3Ma9B96wTQ/+wfXkwRQXwNGATQwi90coL6dRgE0mMJFYIDmdbKLPw+pBeTgHxSgYfUvFLWAkIIfgwY1OMuMC6i3UjcBSD04/R9KFEGns8xoGkjhkHQ+gAdmmbE0lMIh6aoZfgspfFVA3lN4BF13jvCcwmPo2uejghcBAREQkAOgxPOHUnz766QHlD08eZ12fPsrpQdULuty8UVSB/n2V0oPKJkq3wwSmL9SBATEFAPiIA3EaR6IC0UgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgd0Cxvb2Mxy+P9O0v1AURFM9irzdS8e0v0wWAcs93aPLtL9MFgNLI71vDfPvL5A4oX8k/5Rqiv1DOgPKVvYbub5Dw7S8Vp3kgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAvovaMqfL+x8CtYAAAAASUVORK5CYII=" /><!-- --></p>
<p>At last, we choose <span class="math inline">\(\sigma=4,5,10,15,20\)</span> to check whether the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>. From these histograms, We can see, no matter the choice of <span class="math inline">\(\sigma\)</span>, this algorithm make the mode of the generated samples close to the theoretical mode <span class="math inline">\(\sigma\)</span>.</p>
<p><br />
3.11:<br />
In this exercise, we choose <span class="math inline">\(p=0.75,0.6,0.5,0.4,0.1\)</span> to observe whether the empirical distribution of the mixture appears to be bimodal.<br />
The algorithm steps are as follow:<br />
step 1: Generate <span class="math inline">\(X_1\sim N(0,1),X_2\sim N(3,1)\)</span>.<br />
step 2: Sample 0 and 1 from the given 0-1 binomial distribution(<span class="math inline">\(P(x=1)=p\)</span>).<br />
step 3: Calculate <span class="math inline">\(pX_1+(1-p)X_2\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>x1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>x2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a>r1&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.75</span>,<span class="fl">0.25</span>))</span>
<span id="cb5-5"><a href="#cb5-5"></a>z1&lt;-r1<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r1)<span class="op">*</span>x2</span>
<span id="cb5-6"><a href="#cb5-6"></a>r2&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.6</span>,<span class="fl">0.4</span>))</span>
<span id="cb5-7"><a href="#cb5-7"></a>z2&lt;-r2<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r2)<span class="op">*</span>x2</span>
<span id="cb5-8"><a href="#cb5-8"></a>r3&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb5-9"><a href="#cb5-9"></a>z3&lt;-r3<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r3)<span class="op">*</span>x2</span>
<span id="cb5-10"><a href="#cb5-10"></a>r4&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>))</span>
<span id="cb5-11"><a href="#cb5-11"></a>z4&lt;-r4<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r4)<span class="op">*</span>x2</span>
<span id="cb5-12"><a href="#cb5-12"></a>r5&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>))</span>
<span id="cb5-13"><a href="#cb5-13"></a>z5&lt;-r5<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r5)<span class="op">*</span>x2</span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="kw">hist</span>(z1,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.75</span>));</span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="kw">hist</span>(z2,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.6</span>));</span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="kw">hist</span>(z3,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.5</span>));</span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="kw">hist</span>(z4,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.4</span>));</span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">hist</span>(z5,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.1</span>));</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From these histograms, we can see that when <span class="math inline">\(p=0.5\)</span>，the histogram is closest to bimodal.<br />
Because the two random variables obey the normal distribution with equal variance and mean value of 0 and 1 respectively, we can see that the peak is basically at the mean value. Therefore, we speculate that bimodal mixtures are generated when <span class="math inline">\(p=0.5\)</span>.</p>
<p><br />
3.20<br />
According to this compound Poisson process, <span class="math inline">\(N(t)\sim P(\lambda t)\)</span>, <span class="math inline">\(Y_i\sim Gamma(\alpha,\beta)\)</span>,the algorithm steps are as follow:<br />
step 1: Generate <span class="math inline">\(N(t)\sim P(\lambda t)\)</span>.<br />
step 2: Generate a corresponding number of <span class="math inline">\(Y\)</span> according to the value of <span class="math inline">\(N(t)\)</span>.<br />
step 3: Calculate <span class="math inline">\(X=\Sigma_{i=1}^{N(t)}Y_i\)</span>.<br />
step 4: Repeat step1-3, then calculate the mean and the variance of <span class="math inline">\(X\)</span>.<br />
In this exercise, we assume <span class="math inline">\(\alpha=4,\beta=3,\lambda=5\)</span> to estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> and compare with the theoretical values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n&lt;-<span class="fl">1e4</span>;alpha&lt;-<span class="dv">4</span>;beta&lt;-<span class="dv">3</span>;lambda&lt;-<span class="dv">5</span>;t&lt;-<span class="dv">10</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>x&lt;-<span class="kw">numeric</span>(n) </span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb6-5"><a href="#cb6-5"></a>  Nt&lt;-<span class="kw">rpois</span>(<span class="dv">1</span>,lambda<span class="op">*</span>t)</span>
<span id="cb6-6"><a href="#cb6-6"></a>  y&lt;-<span class="kw">rgamma</span>(Nt,alpha,beta)</span>
<span id="cb6-7"><a href="#cb6-7"></a>  x[i]&lt;-<span class="kw">sum</span>(y)</span>
<span id="cb6-8"><a href="#cb6-8"></a>}</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>meanm&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb6-11"><a href="#cb6-11"></a>varm&lt;-<span class="kw">var</span>(x)</span>
<span id="cb6-12"><a href="#cb6-12"></a>meanr&lt;-lambda<span class="op">*</span>t<span class="op">*</span>(alpha<span class="op">/</span>beta)</span>
<span id="cb6-13"><a href="#cb6-13"></a>varr&lt;-lambda<span class="op">*</span>t<span class="op">*</span>(alpha<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>alpha)<span class="op">/</span>beta<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a>meanm</span></code></pre></div>
<pre><code>## [1] 66.72492</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>varm</span></code></pre></div>
<pre><code>## [1] 113.241</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>meanr</span></code></pre></div>
<pre><code>## [1] 66.66667</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>varr</span></code></pre></div>
<pre><code>## [1] 111.1111</code></pre>
<p>Then we change the parameters into <span class="math inline">\(\alpha=2,\beta=5,\lambda=4\)</span>. The estimate mean is 15.99355 and the estimate variance is 9.625297, while the theoretical mean is 16 and the theoretical variance is 9.6.<br />
Therefore, our algorithm for generating random numbers can effectively approximate the theoretical value.<br />
## homework for 09.30 ## Question Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>5.4:<br />
The probability density function of <span class="math inline">\(Be(\alpha,\beta)\)</span> is <span class="math display">\[f(t;\alpha,\beta)=\frac{1}{B(\alpha,\beta)}t^{\alpha-1}(1-t)^{\beta-1}, 0&lt;t&lt;1.\]</span><br />
The cumulative distribution function is <span class="math display">\[F(x)=\int_0^x\frac{1}{B(\alpha,\beta)}t^{\alpha-1}(1-t)^{\beta-1}dt, 0&lt;x&lt;1.\]</span><br />
To caculate this integral, we change it into <span class="math display">\[F(x)=\frac{1}{B(\alpha,\beta)}\int_0^xxt^{\alpha-1}(1-t)^{\beta-1}\frac{1}{x}dx=\frac{1}{B(\alpha,\beta)}E(xt^{\alpha-1}(1-t)^{\beta-1}),t\sim U(0,x).\]</span> Therefore, we first write function <span class="math inline">\(F\)</span>, in our codes, to calculate the value of cumulative distribution function at point <span class="math inline">\(X\)</span> by usinig Monte Carlo Integration method.<br />
Then,we draw two lines to compare the estimate value and theoretical value which was caculate by pbeta function in R.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#set parameters</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>x&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>n&lt;-<span class="fl">1e3</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>alpha&lt;-<span class="dv">3</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>beta&lt;-<span class="dv">3</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>F1&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb14-8"><a href="#cb14-8"></a>B&lt;-<span class="kw">factorial</span>(alpha<span class="op">+</span>beta<span class="dv">-1</span>)<span class="op">/</span>(<span class="kw">factorial</span>(alpha<span class="dv">-1</span>)<span class="op">*</span><span class="kw">factorial</span>(beta<span class="dv">-1</span>))</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#function to caculate MC Integration</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>F&lt;-<span class="cf">function</span>(t){</span>
<span id="cb14-12"><a href="#cb14-12"></a>  y&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,t)</span>
<span id="cb14-13"><a href="#cb14-13"></a>  m&lt;-B<span class="op">*</span>t<span class="op">*</span><span class="kw">mean</span>(y<span class="op">^</span>(alpha<span class="dv">-1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y)<span class="op">^</span>(beta<span class="dv">-1</span>))</span>
<span id="cb14-14"><a href="#cb14-14"></a>}</span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){</span>
<span id="cb14-16"><a href="#cb14-16"></a>  F1[i]&lt;-<span class="kw">F</span>(x[i])</span>
<span id="cb14-17"><a href="#cb14-17"></a>}</span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="kw">plot</span>(x,F1,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;F(x)&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="kw">lines</span>(x,<span class="kw">pbeta</span>(x,alpha,beta),<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb14-21"><a href="#cb14-21"></a>exbeta&lt;-<span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Monte Carlo Estimate&quot;</span>)),<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;pbeta function in R&quot;</span>)))</span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,exbeta,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAh1BMVEUAAAAAADoAAGYAOjoAOpAAZmYAZrY6AAA6ADo6AGY6kNtmAABmADpmAGZmOpBmZgBmZmZmkJBmtrZmtttmtv+QOgCQOjqQOmaQZgCQkGaQtpCQ2/+2ZgC225C2/7a2/9u2///bkDrb2//b/7bb/9vb///fU2v/tmb/trb/25D//7b//9v///9ngfW0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKNUlEQVR4nO2da2ObNhSGaZbFndNdusW7hW1lW8ts8/9/36QjEAiEXy6SUez3+ZDa8UFYTyQhHWQ3q8hFsq3fQOpQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAYEHZm2ErQWGLiwcFASgIcGVB87v2Rti3yBbkQ9n58uWLeTj5mMBvIWxxIclEj302+bDA7yJsceFQLccZACioS9azU1GQxbSc4dWDgoQROxUF1YxPPSioGm08wt0LqjvX6Ot3Lij7gmb1kQTlWfZ0PqhzvwQpLg56QggXPXEEFY+flaOnqjo97wMUF4OpS8Iogs4HpaV891oZVWuLi4CsJia9hyiCTs+qZ5UPn6rm57riQuMutlDw5FJnvIO0W5D4mR4dPFBjxyBRtbq4kMzNRd3bVWx2ru7O5kFaz/TuJUcED9ykuIknnTM6N8cED3QpErqKzRudm4OCB14uZcOk/fzuJUcFD9ykuAknXPhHuRdBixttJEFyiVeMjEBXF7Sse8mRwQM1RVbPD8sshYnikquXPTZ4YOXMn1NYaiy6etmDgwdW9WLVkMBidXn3kqODB1ZptaC1U4pYY1DdhDYfg1ZPuSJdxU7P5io20n6uJkj0LO9f1a3Pg2T4WeXntgWtG57rMoIHblKc/xwB/NyyoDAr4psWFKSU4IGbFOc7Q4D+Vd2woDXLC6ec4IGbFDcsP5CfJYLKOic4dsMi7HkXFh/Kz2xBaor8ZB6dD+PZnoDnXVZ6uJTuTEGnb7tO3Gdxzruo8IAp71tM2ofrX9USQee/r3reBUWH9LNA0OnZDELnX5aPQDEFhfWz7Cqm920Ua4bouIJC+lk0BplbFiOZsNDnnV3wVhO2bqA2tGoWFE9Q8OF/iaA8y346jCcLw553ZrFh+1e1bJCW3lWmOAaF97NE0Hem6ay8ir0ZZgu6M7ZaarwZoi5Wj7uV17oEiJLuaO6KaVYN5QkQZwyqb6jeaQuawulZT5PuUFBn3wYgVwu2exU0un3eocj2FHSR4+4rCrqImghQ0M0TW9DYTvs3w5Vb0Owl4ObMFnQ7c+RpJLCaV2O5aZGlNwlXDgd6yfkOYweTtLz+U3ZCVWkX5nKec0USBHfau7GmBrlPkKc6ZiGTy0c+L4bmg/IuT3R9r8ba5Yp22nc4H77+oOt6+vb7SYLq6ef50I9+O4Im7JN2op9ySeI+/qqDdbJgr9/sj2q8eznupIcUWXsbpSnyP906c5NWOH34LXv4Uz5s3YnsCNLl1KX9o8KOO136Xj9/saV4zhVJ0ISd9h2UoFLXJN/rCpXZi9ybPD2rLlS8e5WyClnY7Zvw9tj8ybwoi2Md2hxuXrWCpNWp13TISQTp0vUIoOchbSm9c82pd9QWdPzmk2oEr6pC5tBSi9lLvUyV5JfGdffLHE66b+rKyy9VqD1cXm4G6b39O7WCpPT6FG0pvXPNqffMMQjttO+gBJ0P6m//+FkJMgNMLUa/Y2kWUuF67Ol/20WZZfWVSf2wh8tLbQs6PTd2G0EvVedHpxTnXHPqPTcfNLjAjqL7TPGkelhlBdVirKBuDtPpYmq8ePhj1xfUdPHOGFR/Rt0vqFtKP1+axDzoqTp+89fPr9XlFtTQ9Noye7FVRC3IPDUj2kCQU0rZmz0kIuh8+KiGIXcMagW5l9/OZV6GirLTxXpjkCuoU5ojyCmlf6lPRJD5Igv3KtYI2psrSzszlIHtfKhTlnKnt4keu4qJsnro97agupTBuZIRpCtmKmTnQXWV82Zu0k4YZISTyqvfv3vN2/bWmwfV44mqbWn+0aX94xuDpBTfuRIQlDYUBKAgAAUBKAiQkiDPbbRBBqu4sDnyUjKs/0KTsIIroa02kvteHAoa1Hf0awd9wZeoFywlvDGVdgvyCLq0p2S+IGdh5yUBQcf3v++krR93H3d1ozdJqzqDldu1o/6FyYvJHFtSanX0k02G9XNucqRZRbTPGzPDpGOPFATtMrNEkCyWJGmapJU0iiadpbGrJRFkUmp1rmtvX+vn3NoD2+dvqgVJ+q7QK3l58PDJJq2kWk06S+MKalJqe+e1Qc6tfXHfWeqKmeItjEHmLasK2Qc2adUMK6XbU9p1fpvi6CXDuhmT/oH6eXMVg8NWCoLeax1akDxQP23SyiSJ63SWxivovdv9Bjm3/oH6ubSg4w51sMQEuS2oqnqZiSpoC9JuJmSEUxAkQ09ux6DHz/aCLRmeJp3V/KKbzrdjUeUdg5Agz93HPkkIknzNS/vAJq103W06S2ME6MRj1jYQHa0q3CTDBjm35kCPILOXMki9Ywr6aO7f2QeVTVrpDJZNZ1U2jZZlP3aHGJkH2WTYMOdWjQpq7wGvrne8e/Np72RM4N78HQqad2f1DgV1lo0T7s2nTQItKG0SuDefNgncm0+bBOZBaUNBgNiC7m0j+erT3fpG8vuDggAJLFbTZqvFavZmiCFo1VJj4ok2CQtVxKrF6j0IYgtCrFms3oWgNYvV+xAU/0QUlGJY5CKCnoiCUgyLXMRtQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggCxBZXmY9uC3FXz52q7YZqRT+s4YfpzQP4t9U6Y3iu7YjNgZEF6c32zwV6+M6Dw1qkbJs/9SV0nrJRvzoGlFc0m7YXEFWTug+SmFmZXp29fiBNWSerbJ8gJM09gaWbjdI4/vDFGXEEeJ/1vGfGFFeZLqy6GNZ91AWGpCzIfaOkKyj1/816Yeuodg5yw8uHPZ/+I5paWdhczzcUdXTx1csN0F/EKcsLki7i8nyzsnbQ//s/kyoLK0TG6DdN3bScIejdonN7SdIvtfHfZbK7bxUbuyDph8gR3MTPG+Lbzu6WNXhkmctVBeuwzOE5YUe9P8dS8G2YE+IZqN2zQyWdyxcv8+Edt+5f5kRbkhJmtJr4u5plbrPjkxBUnihdGgv5EcWQm7c4AVYj/C4ydsLTHoPq7pOqvxDNdx9vaO2HCyFLDCStHFy5OWD4aNgkuVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYDUBemNYpf+35bopC5Ib5Ha9ItjUxek90N/WLGLdzXJCzL/j+R2pC9ozTb5ACQv6Hz4YdMvJUxeUPH4r3cr67VIXZD9P0q2InVBueyG3nCYTl3Q5lAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/Aeh2BkU4DcDzAAAAAElFTkSuQmCC" /><!-- --></p>
<p>As can be seen from the figure, the two lines almost coincide. So our Monte Carlo integration method is correct.</p>
<p><br />
5.9:<br />
In our analysis, the CDF can be written into <span class="math display">\[F(x)=\int _0^x \frac{u}{\sigma^2}e^\frac{-u^2}{2\sigma^2}du=\int _0^x x\frac{u}{\sigma^2}e^\frac{-u^2}{2\sigma^2}\frac{1}{x}du=E(x\frac{u}{\sigma^2}e^\frac{-u^2}{2\sigma^2}),u\sim U(0,x).\]</span><br />
The simple estimator is <span class="math inline">\(X=\frac{1}{m}\Sigma_{i=1}^m(x\frac{u_i}{\sigma^2}e^\frac{-u_i^2}{2\sigma^2}),u_i\sim U(0,x)\)</span>.<br />
The antithetic variable estimator is <span class="math inline">\(X=\frac{1}{m}\Sigma_{i=1}^{\frac{m}{2}}(x\frac{u_i}{\sigma^2}e^\frac{-u_i^2}{2\sigma^2}+x\frac{x-u_i}{\sigma^2}e^\frac{-(x-u_i)^2}{2\sigma^2}),u_i\sim U(0,x)\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>n&lt;-<span class="fl">1e3</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>x&lt;-<span class="dv">2</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>sig&lt;-<span class="dv">4</span> <span class="co">#Here we set the upper limit x=2, parameter sigma=4. You can choose any value of these two parameters. </span></span>
<span id="cb15-5"><a href="#cb15-5"></a>u&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,x)</span>
<span id="cb15-6"><a href="#cb15-6"></a>ua&lt;-<span class="kw">c</span>(u[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)])<span class="co">#use half of u to construct antithetic variable</span></span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>mcm&lt;-x<span class="op">*</span><span class="kw">mean</span>(u<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sig<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>mcv&lt;-<span class="kw">var</span>(u<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>n</span>
<span id="cb15-10"><a href="#cb15-10"></a>antimcm&lt;-x<span class="op">*</span><span class="kw">sum</span>(ua<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>ua<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sig<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(x<span class="op">-</span>ua)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">-</span>ua)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>n</span>
<span id="cb15-11"><a href="#cb15-11"></a>antimcv&lt;-<span class="kw">var</span>(ua<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>ua<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sig<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(x<span class="op">-</span>ua)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">-</span>ua)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sig<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="kw">cat</span>(<span class="st">&quot;The percent reduction in variance is&quot;</span>,antimcv<span class="op">/</span>mcv)</span></code></pre></div>
<pre><code>## The percent reduction in variance is 0.6234485</code></pre>
<p>After that, we conducted several experiments with this program, and the reduction of variance was about 40%.</p>
<p><br />
5.13:<br />
Considering the features of importance function, we need to find functions supported on <span class="math inline">\((1,+\infty)\)</span> (i.e. <span class="math inline">\(\int_1^{+\infty}f(x)dx=1\)</span>) and from which random numbers are easy to generate. Therefore, we find: <span class="math display">\[f_1=\frac{\sqrt e}{10}x^2e^{-\frac{x}{2}},1&lt;x&lt;+\infty.\]</span> <span class="math display">\[f_2=\sqrt exe^-\frac{x^2}{2},1&lt;x&lt;+\infty.\]</span><br />
If we want to reduce the variance as much as possible, we need to choose the function that make <span class="math inline">\(g(x)/f(x)\)</span> a constant.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>x&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># we also tried x&lt;-seq(1,100,1), but the g(x) close to 0 as x increase</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>w&lt;-<span class="dv">2</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>g&lt;-x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb17-5"><a href="#cb17-5"></a>f1&lt;-<span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>))<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">10</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>f2&lt;-<span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>))<span class="op">*</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#figure (a)</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="kw">plot</span>(x,g,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;(a)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="kw">lines</span>(x,g<span class="op">/</span>g,<span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="kw">lines</span>(x,f1,<span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="kw">lines</span>(x,f2,<span class="dt">lty =</span> <span class="dv">4</span>,<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;g/g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>),<span class="dt">lwd =</span> w,<span class="dt">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#figure (b)</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">plot</span>(x,g<span class="op">/</span>g,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;(b)&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">lines</span>(x,g<span class="op">/</span>f1,<span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw">lines</span>(x,g<span class="op">/</span>f2,<span class="dt">lty =</span> <span class="dv">4</span>,<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lwd =</span> w)</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&quot;g/g&quot;</span>,<span class="st">&quot;g/f1&quot;</span>,<span class="st">&quot;g/f2&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>),<span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In order to satisfy <span class="math inline">\(\int_1^{+\infty}f(x)dx=1\)</span>, we find <span class="math inline">\(f_1(x)\)</span> from <span class="math inline">\(Ga(\frac{1}{2},3)\)</span>. Although <span class="math inline">\(f_1(x)\)</span> satisfy our need, it shows far from <span class="math inline">\(g(x)\)</span>.<br />
From figure(a), we can see <span class="math inline">\(f_2\)</span> is closer to <span class="math inline">\(g(x)\)</span>. And <span class="math inline">\(g(x)/f_2(x)\)</span> is a more gentle line in figure(b), the ratio is round <span class="math inline">\(x\)</span>. So <span class="math inline">\(f_2(x)\)</span> produce the smaller variance in estimating.</p>
<p><br />
5.14:<br />
At first, let us recall the standard normal distribution: <span class="math display">\[\phi(x)=\frac{1}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}, E(x)=0, Var(x)=1,\]</span> <span class="math display">\[E(x^2)=Var(x)+E(X)^2=1=\int_{-\infty}^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}dx.\]</span><br />
Therefore, considering the symmetry of this integral, we can write the target integral into <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}dx=\frac{1}{2}-\int_0^1\frac{x^2}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}dx.\]</span><br />
So we only need to obtain a Monte Carlo estimate of <span class="math inline">\(\int_0^1\frac{x^2}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}dx\)</span> by importance sampling.<br />
When <span class="math inline">\(f(x)=xe^{-\frac{x^2}{2}}\)</span>, <span class="math inline">\(\int_0^1f(x)dx=1-\frac{1}{\sqrt{e}}\)</span> (This is consistent with our result in 5.13 <span class="math inline">\(f_2(x)\)</span>). Therefore, let <span class="math inline">\(f^{*}(x)=\frac{xe^{-\frac{x^2}{2}}}{(1-\frac{1}{\sqrt{e}})},0&lt;x&lt;1\)</span>,otherwise <span class="math inline">\(f^{*}(x)=0\)</span>, then <span class="math inline">\(F(x)=\frac{1-e^{-\frac{x^2}{2}}}{(1-\frac{1}{\sqrt{e}})},0&lt;x&lt;1.\)</span> This far, we obtain the density function <span class="math inline">\(f^{*}(x)\)</span> and its distribution function <span class="math inline">\(F(x)\)</span>.<br />
Finally, our integral change into: <span class="math display">\[\int_0^1\frac{x^2}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}dx=\int_0^1\frac{x}{\sqrt{2\pi}}(1-\frac{1}{\sqrt{e}})\frac{xe^{-\frac{x^2}{2}}}{(1-\frac{1}{\sqrt{e}})}dx=E(\frac{x}{\sqrt{2\pi}}(1-\frac{1}{\sqrt{e}})),X\sim F(x).\]</span><br />
After that, we only need to use Inverse Method to generate <span class="math inline">\(x\)</span> from <span class="math inline">\(F(x)\)</span>, and use them to caculate this <span class="math inline">\(E(x)\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>n&lt;-<span class="fl">1e3</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4"></a>x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>)))))<span class="co">#inverse method</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>EX&lt;-<span class="kw">mean</span>(x)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>)))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">cat</span>(<span class="st">&quot;The estimating integral is&quot;</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span>EX)</span></code></pre></div>
<pre><code>## The estimating integral is 0.4004348</code></pre>
</div>
<div id="homework-for-10.14" class="section level2">
<h2>homework for 10.14</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</li>
<li>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.<br />
What is the corresponding hypothesis test problem?<br />
What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?<br />
Please provide the least necessary information for hypothesis testing.</li>
</ol>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>6.5:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>m&lt;-<span class="dv">1000</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>s&lt;-<span class="dv">0</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb21-7"><a href="#cb21-7"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a>  y1&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) </span>
<span id="cb21-9"><a href="#cb21-9"></a>  y2&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="cf">if</span> (y1<span class="op">&lt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>y2<span class="op">&gt;</span><span class="dv">2</span>) {</span>
<span id="cb21-11"><a href="#cb21-11"></a>    s&lt;-s<span class="op">+</span><span class="dv">1</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  }</span>
<span id="cb21-13"><a href="#cb21-13"></a>}</span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="kw">cat</span>(<span class="st">&quot;The coverage probability of the t-interval is&quot;</span>,s<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## The coverage probability of the t-interval is 0.926</code></pre>
<p>The sample data are generated from <span class="math inline">\(\chi^2(2)\)</span>, then the coverage probability is 92.6%, which are smaller than 0.95.<br />
The simulation result in Example 6.4 shows that the empirical confidence level is 95.6% when the sampled population is normal. But the coverage probability reduce to 77.3% prominently when the sampled population is normal(Example 6.6), which is far from the 95% coverage under normality.<br />
Therefore, we can see the t-interval is more robust to departures from normality than the interval for variance.</p>
<p><br />
6.A:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>m&lt;-<span class="dv">1000</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>s&lt;-<span class="dv">0</span> </span>
<span id="cb23-5"><a href="#cb23-5"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>mu0&lt;-<span class="dv">1</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb23-9"><a href="#cb23-9"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb23-10"><a href="#cb23-10"></a>  y1&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) </span>
<span id="cb23-11"><a href="#cb23-11"></a>  y2&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="cf">if</span> (y1<span class="op">&lt;</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>y2<span class="op">&gt;</span><span class="dv">1</span>) {</span>
<span id="cb23-13"><a href="#cb23-13"></a>    s&lt;-s<span class="op">+</span><span class="dv">1</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  }</span>
<span id="cb23-15"><a href="#cb23-15"></a>  ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">mu=</span>mu0)</span>
<span id="cb23-16"><a href="#cb23-16"></a>  p[i]&lt;-ttest<span class="op">$</span>p.value</span>
<span id="cb23-17"><a href="#cb23-17"></a>}</span>
<span id="cb23-18"><a href="#cb23-18"></a>p.hat&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</span>
<span id="cb23-19"><a href="#cb23-19"></a>se.hat&lt;-<span class="kw">round</span>(<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m),<span class="dv">3</span>)</span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="kw">cat</span>(<span class="st">&quot;The coverage probability of the t-interval is&quot;</span>,s<span class="op">/</span>m,<span class="st">&quot;. The p-value is&quot;</span>,p.hat,<span class="st">&quot;. And the standard error of the estimate is approximately&quot;</span>,se.hat,<span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre><code>## The coverage probability of the t-interval is 0.908 . The p-value is 0.092 . And the standard error of the estimate is approximately 0.009 .</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>m&lt;-<span class="dv">1000</span> </span>
<span id="cb25-4"><a href="#cb25-4"></a>s&lt;-<span class="dv">0</span> </span>
<span id="cb25-5"><a href="#cb25-5"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>mu0&lt;-<span class="dv">1</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb25-9"><a href="#cb25-9"></a>  x&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb25-10"><a href="#cb25-10"></a>  y1&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) </span>
<span id="cb25-11"><a href="#cb25-11"></a>  y2&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb25-12"><a href="#cb25-12"></a>  <span class="cf">if</span> (y1<span class="op">&lt;</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>y2<span class="op">&gt;</span><span class="dv">1</span>) {</span>
<span id="cb25-13"><a href="#cb25-13"></a>    s&lt;-s<span class="op">+</span><span class="dv">1</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>  }</span>
<span id="cb25-15"><a href="#cb25-15"></a>  ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">mu=</span>mu0)</span>
<span id="cb25-16"><a href="#cb25-16"></a>  p[i]&lt;-ttest<span class="op">$</span>p.value</span>
<span id="cb25-17"><a href="#cb25-17"></a>}</span>
<span id="cb25-18"><a href="#cb25-18"></a>p.hat&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</span>
<span id="cb25-19"><a href="#cb25-19"></a>se.hat&lt;-<span class="kw">round</span>(<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m),<span class="dv">3</span>)</span>
<span id="cb25-20"><a href="#cb25-20"></a><span class="kw">cat</span>(<span class="st">&quot;The coverage probability of the t-interval is&quot;</span>,s<span class="op">/</span>m,<span class="st">&quot;. The p-value is&quot;</span>,p.hat,<span class="st">&quot;. And the standard error of the estimate is approximately&quot;</span>,se.hat,<span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre><code>## The coverage probability of the t-interval is 0.938 . The p-value is 0.062 . And the standard error of the estimate is approximately 0.008 .</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>m&lt;-<span class="dv">1000</span> </span>
<span id="cb27-4"><a href="#cb27-4"></a>s&lt;-<span class="dv">0</span> </span>
<span id="cb27-5"><a href="#cb27-5"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>mu0&lt;-<span class="dv">1</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb27-9"><a href="#cb27-9"></a>  x&lt;-<span class="kw">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb27-10"><a href="#cb27-10"></a>  y1&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) </span>
<span id="cb27-11"><a href="#cb27-11"></a>  y2&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="cf">if</span> (y1<span class="op">&lt;</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>y2<span class="op">&gt;</span><span class="dv">1</span>) {</span>
<span id="cb27-13"><a href="#cb27-13"></a>    s&lt;-s<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  }</span>
<span id="cb27-15"><a href="#cb27-15"></a>  ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">mu=</span>mu0)</span>
<span id="cb27-16"><a href="#cb27-16"></a>  p[i]&lt;-ttest<span class="op">$</span>p.value</span>
<span id="cb27-17"><a href="#cb27-17"></a>}</span>
<span id="cb27-18"><a href="#cb27-18"></a>p.hat&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</span>
<span id="cb27-19"><a href="#cb27-19"></a>se.hat&lt;-<span class="kw">round</span>(<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m),<span class="dv">3</span>)</span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="kw">cat</span>(<span class="st">&quot;The coverage probability of the t-interval is&quot;</span>,s<span class="op">/</span>m,<span class="st">&quot;. The p-value is&quot;</span>,p.hat,<span class="st">&quot;. And the standard error of the estimate is approximately&quot;</span>,se.hat,<span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre><code>## The coverage probability of the t-interval is 0.917 . The p-value is 0.083 . And the standard error of the estimate is approximately 0.009 .</code></pre>
<p>From the results above, the coverage probability of the t-interval are 0.908, 0.938 and 0.917 respectively. Therefore, the t-test is robust to mild departures from normality.<br />
And the hypothesis tests show that all the p-value (0.092, 0.062, 0.083) are larger than 0.05, then they accept the null hypothesis.</p>
<p><br />
Discussion:<br />
The null hypothesis is <span class="math inline">\(H_0:power_1=power_2\)</span> (the two power means are equal). The alternative hypothesis is <span class="math inline">\(H_a:power_1\neq power_2\)</span>.<br />
Paired-t test should be used to this problem.<br />
Paired-t test is to analysis two groups of sample from the same population under the influence of different conditions to evaluate whether different conditions have a significant impact on it.<br />
Therefore, to conduct a hypothesis test we need to know:<br />
(1) Samples must be independent. Two methods of obtaining the powers won’t affect each other.<br />
(2) Powers should be obtained from the same sample.<br />
(3) Assume the differences of two methods are normally distributed.</p>
</div>
<div id="homework-for-10.21" class="section level2">
<h2>homework for 10.21</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R)</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>6.C:<br />
Part 1: Hypothesis test<br />
According to Mardia’s paper, to test <span class="math inline">\(\beta_{1,d}=0\)</span> for large samples, we calculate <span class="math inline">\(A=\frac{nb_{1,d}}{6}\)</span> and reject the hypothesis for large values of <span class="math inline">\(A\)</span>. So the null hypothesis is <span class="math inline">\(H_0:A=0\)</span>, the alternative hypothesis is <span class="math inline">\(H_1:A&gt;0\)</span>,where <span class="math inline">\(A\sim \chi^2(\frac{d(d+1)(d+2)}{6})\)</span>.<br />
Because the degrees of freedom have nothing to do with sample, we can generate samples from multivariate normal distributions. And when the random vector obeys the multivariate normal distribution, each one-dimensional component of the random vector obeys the normal distribution.<br />
In the code below, the outer loop varies the sample size m and the inner loop is the simulation for the current sample. In the simulation, we first generate <span class="math inline">\(X\)</span> and calculate the corresponding <span class="math inline">\(A\)</span>. The test decisions are saved as 1 (reject <span class="math inline">\(H_0\)</span>) or 0 (do not reject <span class="math inline">\(H_0\)</span>) in the vector sktests.<br />
When the simulation for n ends, we have a value of <span class="math inline">\(A\)</span>. When the simulation for m ends, the mean of sktests gives the sample proportion of significant tests. This result is saved in p.reject.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>d &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">#dimension</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>m &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#sample sizes of A</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>n &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co">#sample sizes of X in each A</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb29-7"><a href="#cb29-7"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">95</span>, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a>skn&lt;-<span class="cf">function</span>(x){</span>
<span id="cb29-10"><a href="#cb29-10"></a>    xbar &lt;-<span class="st">  </span><span class="kw">apply</span>(x,<span class="dv">1</span>,mean)</span>
<span id="cb29-11"><a href="#cb29-11"></a>    y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> d, <span class="dt">ncol =</span> n)</span>
<span id="cb29-12"><a href="#cb29-12"></a>    s &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> n)</span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb29-14"><a href="#cb29-14"></a>        y[,a] &lt;-<span class="st"> </span>x[,a] <span class="op">-</span><span class="st"> </span>xbar</span>
<span id="cb29-15"><a href="#cb29-15"></a>    }</span>
<span id="cb29-16"><a href="#cb29-16"></a>    cov &lt;-<span class="st"> </span><span class="kw">cov</span>(<span class="kw">t</span>(x))</span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb29-18"><a href="#cb29-18"></a>        s[b] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>        <span class="cf">for</span> (c <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb29-20"><a href="#cb29-20"></a>            s[b] &lt;-<span class="st"> </span>s[b]<span class="op">+</span>(<span class="kw">t</span>(y[,b])<span class="op">%*%</span><span class="kw">ginv</span>(cov)<span class="op">%*%</span>y[,c])<span class="op">^</span><span class="dv">3</span></span>
<span id="cb29-21"><a href="#cb29-21"></a>         }</span>
<span id="cb29-22"><a href="#cb29-22"></a>    }</span>
<span id="cb29-23"><a href="#cb29-23"></a>    <span class="kw">return</span>(<span class="kw">sum</span>(s)<span class="op">/</span>n<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb29-24"><a href="#cb29-24"></a>}</span>
<span id="cb29-25"><a href="#cb29-25"></a></span>
<span id="cb29-26"><a href="#cb29-26"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb29-27"><a href="#cb29-27"></a>    x&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(d<span class="op">*</span>n), <span class="dt">nrow =</span> d, <span class="dt">ncol =</span> n)</span>
<span id="cb29-28"><a href="#cb29-28"></a>   <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb29-29"><a href="#cb29-29"></a>    sktests[k] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">skn</span>(x) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb29-30"><a href="#cb29-30"></a>}</span>
<span id="cb29-31"><a href="#cb29-31"></a>p.reject &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb29-32"><a href="#cb29-32"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>We also change n into 10,20,50 and 100, codes are same as above. And p-value become larger as n increasing.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>result&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>result[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.000</span>,<span class="fl">0.000</span>,<span class="fl">0.030</span>,<span class="fl">0.060</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="kw">dimnames</span>(result)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n=10&quot;</span>,<span class="st">&quot;n=20&quot;</span>,<span class="st">&quot;n=50&quot;</span>,<span class="st">&quot;n=100&quot;</span>) </span>
<span id="cb31-4"><a href="#cb31-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">n=10</th>
<th align="right">n=20</th>
<th align="right">n=50</th>
<th align="right">n=100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.03</td>
<td align="right">0.06</td>
</tr>
</tbody>
</table>
<p>Part 2：Power<br />
In this part, we interpreted the question as that the samples with Epsilon proportion in the data were contaminated, and the contaminated samples came from the multivariate normal distribution samples with all diagonal elements of covariance matrix being 10.<br />
Since such multivariate normal random vectors obey the normal distribution of <span class="math inline">\(N(0,10)\)</span> in each dimension, we still use the normal distribution of one dimension for sampling.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb32-7"><a href="#cb32-7"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb32-8"><a href="#cb32-8"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb32-9"><a href="#cb32-9"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb32-13"><a href="#cb32-13"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb32-15"><a href="#cb32-15"></a>    sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> d<span class="op">*</span>n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb32-16"><a href="#cb32-16"></a>    x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(d<span class="op">*</span>n,<span class="dv">0</span>,sigma), <span class="dt">nrow =</span> d, <span class="dt">ncol =</span> n)</span>
<span id="cb32-17"><a href="#cb32-17"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skn</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb32-18"><a href="#cb32-18"></a>  }</span>
<span id="cb32-19"><a href="#cb32-19"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb32-20"><a href="#cb32-20"></a>}</span>
<span id="cb32-21"><a href="#cb32-21"></a></span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb32-24"><a href="#cb32-24"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb32-25"><a href="#cb32-25"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb32-26"><a href="#cb32-26"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb32-27"><a href="#cb32-27"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power curve shows that the power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha=0.10\)</span> at both endpoints, <span class="math inline">\(\epsilon=0\)</span> and <span class="math inline">\(0.85\leq\epsilon\leq1\)</span> where the alternative is normally distributed. For <span class="math inline">\(0&lt;\epsilon&lt;0.85\)</span> the empirical power of the test is greater than 0.10 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.10.</p>
</div>
<div id="homework-for-10.28" class="section level2">
<h2>homework for 10.28</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>7.7:<br />
In this problem, we need to combine the data at first in order to use bootstrap function. Then according to the formula, calculate the <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">library</span>(boot); <span class="kw">library</span>(bootstrap); <span class="kw">library</span>(MASS); </span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a>b.pca &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb33-5"><a href="#cb33-5"></a>  lam &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x[i,]))<span class="op">$</span>values</span>
<span id="cb33-6"><a href="#cb33-6"></a>  theta_hat &lt;-<span class="st"> </span>lam[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lam)</span>
<span id="cb33-7"><a href="#cb33-7"></a>} </span>
<span id="cb33-8"><a href="#cb33-8"></a>x &lt;-<span class="st"> </span><span class="kw">cbind</span>(scor<span class="op">$</span>mec, scor<span class="op">$</span>vec, scor<span class="op">$</span>alg, scor<span class="op">$</span>ana, scor<span class="op">$</span>sta)</span>
<span id="cb33-9"><a href="#cb33-9"></a>obj &lt;-<span class="st"> </span><span class="kw">boot</span>(x,<span class="dt">statistic =</span> b.pca, <span class="dt">R =</span> <span class="dv">200</span>)</span>
<span id="cb33-10"><a href="#cb33-10"></a></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>obj<span class="op">$</span>t0,<span class="dt">bias.boot=</span><span class="kw">mean</span>(obj<span class="op">$</span>t)<span class="op">-</span>obj<span class="op">$</span>t0,<span class="dt">se.boot=</span><span class="kw">sd</span>(obj<span class="op">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.boot   se.boot 
##     0.619     0.000     0.048</code></pre>
<p>Under bootstrap, the bias is 0.001, and standard error is 0.047.</p>
<p><br />
7.8:<br />
In this problem, we write a circulation to calculate the jackknife, and use the formulas to ensure unbiased.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>n&lt;-<span class="kw">nrow</span>(scor)</span>
<span id="cb35-2"><a href="#cb35-2"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">b.pca</span>(x,<span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb35-3"><a href="#cb35-3"></a>theta_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb35-6"><a href="#cb35-6"></a>theta_jack[i] &lt;-<span class="st"> </span><span class="kw">b.pca</span>(x,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</span>
<span id="cb35-7"><a href="#cb35-7"></a>}</span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_jack)<span class="op">-</span>theta_hat)</span>
<span id="cb35-10"><a href="#cb35-10"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta_jack<span class="op">-</span>theta_hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb35-11"><a href="#cb35-11"></a></span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta_hat,<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p>Under bootstrap, the bias is 0.001, and standard error is 0.050.</p>
<p><br />
7.9:<br />
Thanks to R, we can use function boot.ci to obtain the confidence intervals directly.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>ci &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>CI &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(obj, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&#39;perc&#39;</span>, <span class="st">&#39;bca&#39;</span>))</span>
<span id="cb37-4"><a href="#cb37-4"></a>ci[<span class="dv">1</span>,]&lt;-CI<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];ci[<span class="dv">2</span>,]&lt;-CI<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a>result&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb37-7"><a href="#cb37-7"></a>result[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(ci[<span class="dv">1</span>,<span class="dv">1</span>],ci[<span class="dv">1</span>,<span class="dv">2</span>],ci[<span class="dv">2</span>,<span class="dv">1</span>],ci[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="kw">dimnames</span>(result)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;perc lower&quot;</span>,<span class="st">&quot;perc upper&quot;</span>,<span class="st">&quot;BCa lower&quot;</span>,<span class="st">&quot;BCa upper&quot;</span>) </span>
<span id="cb37-9"><a href="#cb37-9"></a>knitr<span class="op">::</span><span class="kw">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">perc lower</th>
<th align="right">perc upper</th>
<th align="right">BCa lower</th>
<th align="right">BCa upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.519143</td>
<td align="right">0.7092248</td>
<td align="right">0.5277298</td>
<td align="right">0.7307836</td>
</tr>
</tbody>
</table>
<p><br />
7.B:<br />
In this question, the estimation of coverage probabilities is similar to the example3 in slides.<br />
In the first part, samples are generated from normal distribution. Skewness under <span class="math inline">\(N\sim(0,1)\)</span> is 0.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">#normal populations (skewness=0)</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">library</span>(boot);<span class="kw">library</span>(moments)</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>skew&lt;-<span class="dv">0</span>;n&lt;-<span class="dv">20</span>;m&lt;-<span class="fl">1e3</span>;</span>
<span id="cb38-5"><a href="#cb38-5"></a>ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a>boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="kw">skewness</span>(x[i]) </span>
<span id="cb38-9"><a href="#cb38-9"></a>}</span>
<span id="cb38-10"><a href="#cb38-10"></a></span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="co">#bootstrap</span></span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb38-13"><a href="#cb38-13"></a>U &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb38-14"><a href="#cb38-14"></a>de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U , <span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">200</span>)</span>
<span id="cb38-15"><a href="#cb38-15"></a>ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de , <span class="dt">conf =</span> <span class="fl">0.95</span> , <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb38-16"><a href="#cb38-16"></a>ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb38-17"><a href="#cb38-17"></a>ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb38-18"><a href="#cb38-18"></a>ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb38-19"><a href="#cb38-19"></a>}</span>
<span id="cb38-20"><a href="#cb38-20"></a></span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="co">#coverage probabilities</span></span>
<span id="cb38-22"><a href="#cb38-22"></a><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>skew <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>skew),</span>
<span id="cb38-23"><a href="#cb38-23"></a><span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>skew <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>skew),</span>
<span id="cb38-24"><a href="#cb38-24"></a><span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>skew <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>skew))</span></code></pre></div>
<pre><code>## norm = 0.898 basic = 0.896 perc = 0.976</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">#miss on the left</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="kw">cat</span>(<span class="st">&#39;norm left=&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>skew),</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">&#39;basic left=&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>skew),</span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">&#39;perc left=&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>skew))</span></code></pre></div>
<pre><code>## norm left= 0.047 basic left= 0.051 perc left= 0.013</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">#miss on the right</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">cat</span>(<span class="st">&#39;norm right=&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>skew),</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="st">&#39;basic right=&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>skew),</span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="st">&#39;perc right=&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>skew))</span></code></pre></div>
<pre><code>## norm right= 0.055 basic right= 0.053 perc right= 0.011</code></pre>
<p>The estimation from the percentile confidence interval is much closer to 0.95. And Samples are equally likely to fall to the left and right of the confidence interval.</p>
<p>In the second part, samples are generated from <span class="math inline">\(\chi^2(5)\)</span>. Under <span class="math inline">\(\chi^2(n)\)</span>, the skewness is <span class="math inline">\(\sqrt\frac{8}{n}\)</span>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co">#chisq populations </span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw">library</span>(boot);<span class="kw">library</span>(moments)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb44-4"><a href="#cb44-4"></a>skew&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>);n&lt;-<span class="dv">10</span>;m&lt;-<span class="fl">1e3</span>;</span>
<span id="cb44-5"><a href="#cb44-5"></a>ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a>boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="kw">skewness</span>(x[i]) </span>
<span id="cb44-9"><a href="#cb44-9"></a>}</span>
<span id="cb44-10"><a href="#cb44-10"></a></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="co">#bootstrap </span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb44-13"><a href="#cb44-13"></a>U &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb44-14"><a href="#cb44-14"></a>de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U , <span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">200</span>)</span>
<span id="cb44-15"><a href="#cb44-15"></a>ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de , <span class="dt">conf =</span> <span class="fl">0.95</span> , <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb44-16"><a href="#cb44-16"></a>ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb44-17"><a href="#cb44-17"></a>ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb44-18"><a href="#cb44-18"></a>ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb44-19"><a href="#cb44-19"></a>}</span>
<span id="cb44-20"><a href="#cb44-20"></a></span>
<span id="cb44-21"><a href="#cb44-21"></a><span class="co">#coverage probabilities</span></span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>skew <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>skew),</span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>skew <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>skew),</span>
<span id="cb44-24"><a href="#cb44-24"></a><span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>skew <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>skew))</span></code></pre></div>
<pre><code>## norm = 0.733 basic = 0.714 perc = 0.736</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co">#miss on the left</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">cat</span>(<span class="st">&#39;norm left=&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>skew),</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="st">&#39;basic left=&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>skew),</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="st">&#39;perc left=&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>skew))</span></code></pre></div>
<pre><code>## norm left= 0.009 basic left= 0.036 perc left= 0</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co">#miss on the right</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="kw">cat</span>(<span class="st">&#39;norm right=&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>skew),</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">&#39;basic right=&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>skew),</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="st">&#39;perc right=&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>skew))</span></code></pre></div>
<pre><code>## norm right= 0.258 basic right= 0.25 perc right= 0.264</code></pre>
<p>The estimation from 3 types confidence interval are far from 0.95. And Samples are more likely to fall into the right side of the confidence interval.<br />
We know from the last homework that the skewness of the Chi-square distribution is always positive. When the skewness is too large, the null hypothesis is rejected. However, the confidence interval obtained by the Bootstrap method is bilateral, so the coverage probability of skewness parameters is not very good.</p>
</div>
<div id="homework-for-11.04" class="section level2">
<h2>homework for 11.04</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li>Exercise 8.2 (page 242, Statistical Computating with R).</li>
<li>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.<br />
(1)Unequal variances and equal expectations<br />
(2)Unequal variances and unequal expectations<br />
(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br />
(4)Unbalanced samples (say, 1 case versus 10 controls)<br />
Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</li>
</ol>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="kw">library</span>(RANN)</span></code></pre></div>
<p>8.2:<br />
The bivariate Spearman rank correlation test may be used if the data do not necessarily come from a bivariate normal distribution. And its original hypothesis is that variables are independent of each other. So our two sets of samples, X and Y are drawn from <span class="math inline">\(\chi^2(2)\)</span> and <span class="math inline">\(Gamma(0.5,7)\)</span>. We first drew the scatter plot of the sample, and we can see that X and Y are independent.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>); </span>
<span id="cb51-2"><a href="#cb51-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; </span>
<span id="cb51-3"><a href="#cb51-3"></a>K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>; </span>
<span id="cb51-4"><a href="#cb51-4"></a>m &lt;-<span class="st"> </span><span class="dv">999</span>;</span>
<span id="cb51-5"><a href="#cb51-5"></a>reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(m); </span>
<span id="cb51-6"><a href="#cb51-6"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n1,<span class="dv">2</span>); </span>
<span id="cb51-7"><a href="#cb51-7"></a>y &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n2,<span class="fl">0.5</span>,<span class="dv">7</span>);</span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">main=</span><span class="st">&quot;scatter diagram&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) <span class="co">#sample pool</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>s0 &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y, <span class="dt">method =</span><span class="st">&quot;spearman&quot;</span>,<span class="dt">continuity=</span><span class="ot">TRUE</span>,<span class="dt">conf.level=</span><span class="fl">0.95</span>)<span class="op">$</span>statistic</span>
<span id="cb52-3"><a href="#cb52-3"></a></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb52-5"><a href="#cb52-5"></a>k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb52-6"><a href="#cb52-6"></a>x1 &lt;-<span class="st"> </span>z[k];y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>reps[i] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x1, y1, <span class="dt">method =</span><span class="st">&quot;spearman&quot;</span>,<span class="dt">continuity=</span><span class="ot">TRUE</span>,<span class="dt">conf.level=</span><span class="fl">0.95</span>)<span class="op">$</span>statistic</span>
<span id="cb52-8"><a href="#cb52-8"></a>}</span>
<span id="cb52-9"><a href="#cb52-9"></a>p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(s0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(s0))</span>
<span id="cb52-10"><a href="#cb52-10"></a></span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="kw">round</span>(<span class="kw">c</span>(p,<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span><span class="st">&quot;spearman&quot;</span>,<span class="dt">continuity=</span><span class="ot">TRUE</span>,<span class="dt">conf.level=</span><span class="fl">0.95</span>)<span class="op">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.486 0.969</code></pre>
<p>After permutation, we obtained the p-value of 0.969. The function cor.test yields a p-value of 0.486. Both methods accepted the null hypothesis and permutation had a higher P-value.</p>
<p><br />
Experiments:<br />
(1)Unequal variances and equal expectations<br />
<span class="math display">\[X\sim N(0,1.5),y\sim N(0,1)\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e2</span>; k &lt;-<span class="st"> </span><span class="dv">3</span>; p &lt;-<span class="st"> </span><span class="dv">2</span>; </span>
<span id="cb54-3"><a href="#cb54-3"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R &lt;-<span class="st"> </span><span class="dv">99</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb54-4"><a href="#cb54-4"></a></span>
<span id="cb54-5"><a href="#cb54-5"></a><span class="co">#KNN</span></span>
<span id="cb54-6"><a href="#cb54-6"></a>Tn3 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb54-7"><a href="#cb54-7"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb54-8"><a href="#cb54-8"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb54-9"><a href="#cb54-9"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb54-10"><a href="#cb54-10"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb54-11"><a href="#cb54-11"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb54-12"><a href="#cb54-12"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb54-13"><a href="#cb54-13"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;=</span><span class="st"> </span>n1); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1)</span>
<span id="cb54-14"><a href="#cb54-14"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb54-15"><a href="#cb54-15"></a>}</span>
<span id="cb54-16"><a href="#cb54-16"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb54-17"><a href="#cb54-17"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3, <span class="dt">R =</span> R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes, <span class="dt">k =</span> k)</span>
<span id="cb54-18"><a href="#cb54-18"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb54-19"><a href="#cb54-19"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts <span class="op">&gt;=</span><span class="st"> </span>ts[<span class="dv">1</span>])</span>
<span id="cb54-20"><a href="#cb54-20"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb54-21"><a href="#cb54-21"></a>}</span>
<span id="cb54-22"><a href="#cb54-22"></a></span>
<span id="cb54-23"><a href="#cb54-23"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb54-24"><a href="#cb54-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb54-25"><a href="#cb54-25"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb54-26"><a href="#cb54-26"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2));</span>
<span id="cb54-27"><a href="#cb54-27"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb54-28"><a href="#cb54-28"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb54-29"><a href="#cb54-29"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb54-30"><a href="#cb54-30"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb54-31"><a href="#cb54-31"></a>}</span>
<span id="cb54-32"><a href="#cb54-32"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb54-33"><a href="#cb54-33"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb54-34"><a href="#cb54-34"></a><span class="kw">cat</span>(<span class="st">&quot; power of NN =&quot;</span>,pow1[<span class="dv">1</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&quot;power of energy =&quot;</span>,pow1[<span class="dv">2</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, <span class="st">&quot;power of ball =&quot;</span>, pow1[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##  power of NN = 0.43 
##  power of energy = 0.52 
##  power of ball = 0.9</code></pre>
<p>(2)Unequal variances and unequal expectations <span class="math display">\[x\sim N(1,3),Y\sim N(0.5,4)\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb56-4"><a href="#cb56-4"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb56-5"><a href="#cb56-5"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="fl">0.5</span>,<span class="dv">4</span>),<span class="kw">rnorm</span>(n2,<span class="fl">0.5</span>,<span class="dv">4</span>));</span>
<span id="cb56-6"><a href="#cb56-6"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb56-7"><a href="#cb56-7"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb56-8"><a href="#cb56-8"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb56-9"><a href="#cb56-9"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb56-10"><a href="#cb56-10"></a>}</span>
<span id="cb56-11"><a href="#cb56-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb56-12"><a href="#cb56-12"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb56-13"><a href="#cb56-13"></a><span class="kw">cat</span>(<span class="st">&quot; power of NN =&quot;</span>,pow2[<span class="dv">1</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&quot;power of energy =&quot;</span>,pow2[<span class="dv">2</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, <span class="st">&quot;power of ball =&quot;</span>, pow2[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##  power of NN = 0.25 
##  power of energy = 0.44 
##  power of ball = 0.71</code></pre>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) <span class="math display">\[X\sim t(1),Y\sim 0.3N(0,1)+0.7N(1,1)\]</span></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb58-4"><a href="#cb58-4"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb58-5"><a href="#cb58-5"></a>  mu &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n2<span class="op">*</span>p, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>))</span>
<span id="cb58-6"><a href="#cb58-6"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,mu,<span class="dv">1</span>), <span class="dt">ncol =</span> p)</span>
<span id="cb58-7"><a href="#cb58-7"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb58-8"><a href="#cb58-8"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb58-9"><a href="#cb58-9"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb58-10"><a href="#cb58-10"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb58-11"><a href="#cb58-11"></a>}</span>
<span id="cb58-12"><a href="#cb58-12"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb58-13"><a href="#cb58-13"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb58-14"><a href="#cb58-14"></a><span class="kw">cat</span>(<span class="st">&quot; power of NN =&quot;</span>,pow3[<span class="dv">1</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&quot;power of energy =&quot;</span>,pow3[<span class="dv">2</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, <span class="st">&quot;power of ball =&quot;</span>, pow3[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##  power of NN = 0.98 
##  power of energy = 1 
##  power of ball = 1</code></pre>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls) <span class="math display">\[X,Y\sim N(1,1),n_1=10,n_2=100\]</span></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a>n1&lt;-<span class="dv">10</span>;n2&lt;-<span class="dv">100</span>;n=n1<span class="op">+</span>n2;N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb60-3"><a href="#cb60-3"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb60-5"><a href="#cb60-5"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">ncol =</span> p);</span>
<span id="cb60-6"><a href="#cb60-6"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2))</span>
<span id="cb60-7"><a href="#cb60-7"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb60-8"><a href="#cb60-8"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb60-9"><a href="#cb60-9"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb60-10"><a href="#cb60-10"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb60-11"><a href="#cb60-11"></a>}</span>
<span id="cb60-12"><a href="#cb60-12"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb60-13"><a href="#cb60-13"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb60-14"><a href="#cb60-14"></a><span class="kw">cat</span>(<span class="st">&quot; power of NN =&quot;</span>,pow4[<span class="dv">1</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&quot;power of energy =&quot;</span>,pow4[<span class="dv">2</span>],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, <span class="st">&quot;power of ball =&quot;</span>, pow4[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##  power of NN = 0.59 
##  power of energy = 0.99 
##  power of ball = 0.97</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>power &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(pow1, pow2, pow3, pow4)) </span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">colnames</span>(power) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;unequal var&quot;</span>,<span class="st">&quot;unequal var&amp;ex&quot;</span>,<span class="st">&quot;Non-normal distributions&quot;</span>,<span class="st">&quot;Unbalanced samples&quot;</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="kw">rownames</span>(power) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;Energy&quot;</span>, <span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb62-4"><a href="#cb62-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(power) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">unequal var</th>
<th align="right">unequal var&amp;ex</th>
<th align="right">Non-normal distributions</th>
<th align="right">Unbalanced samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NN</td>
<td align="right">0.43</td>
<td align="right">0.25</td>
<td align="right">0.98</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">Energy</td>
<td align="right">0.52</td>
<td align="right">0.44</td>
<td align="right">1.00</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">Ball</td>
<td align="right">0.90</td>
<td align="right">0.71</td>
<td align="right">1.00</td>
<td align="right">0.97</td>
</tr>
</tbody>
</table>
<p>The Ball method has the best results in the two cases with unequal variances and unequal variance and mean. In the latter two cases, the Energy approach is better. NN method works well with non-normal and unbalanced samples.</p>
</div>
<div id="homework-for-11.11" class="section level2">
<h2>homework for 11.11</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>1.Exercise 9.3 and 9.8 (pages 277-278, Statistical Computating with R).<br />
2.For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>9.3:<br />
In this question, we choose proposal distribution as <span class="math inline">\(N(x_t,\sigma^2)\)</span>,<span class="math inline">\(\sigma =2\)</span>. We separate this question into three parts. In the first part, we write the codes to generate a Markov Chian using the algorithm in the slides. And we also calculate the reject probability. In the second part, We draw the Trace Plot with the number of iterations as the horizontal axis and the value of Markov Chain as the vertical axis. In the third part, We drew the QQ plot.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co">#standard cauchy dist</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, theta) {</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb63-4"><a href="#cb63-4"></a>}</span>
<span id="cb63-5"><a href="#cb63-5"></a></span>
<span id="cb63-6"><a href="#cb63-6"></a><span class="co">#MCMC</span></span>
<span id="cb63-7"><a href="#cb63-7"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb63-8"><a href="#cb63-8"></a>m &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb63-9"><a href="#cb63-9"></a>theta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb63-11"><a href="#cb63-11"></a>burn &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb63-12"><a href="#cb63-12"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb63-13"><a href="#cb63-13"></a></span>
<span id="cb63-14"><a href="#cb63-14"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> theta) <span class="co">#proposal dist</span></span>
<span id="cb63-15"><a href="#cb63-15"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb63-16"><a href="#cb63-16"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb63-17"><a href="#cb63-17"></a></span>
<span id="cb63-18"><a href="#cb63-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {</span>
<span id="cb63-19"><a href="#cb63-19"></a>xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb63-20"><a href="#cb63-20"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt, <span class="dt">sd =</span> sigma)</span>
<span id="cb63-21"><a href="#cb63-21"></a>num &lt;-<span class="st"> </span><span class="kw">f</span>(y, theta) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb63-22"><a href="#cb63-22"></a>den &lt;-<span class="st"> </span><span class="kw">f</span>(xt, theta) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb63-23"><a href="#cb63-23"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb63-24"><a href="#cb63-24"></a>x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb63-25"><a href="#cb63-25"></a>k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb63-26"><a href="#cb63-26"></a>}</span>
<span id="cb63-27"><a href="#cb63-27"></a>}</span>
<span id="cb63-28"><a href="#cb63-28"></a></span>
<span id="cb63-29"><a href="#cb63-29"></a><span class="kw">cat</span>(<span class="st">&#39;reject probability: &#39;</span>,<span class="kw">round</span>(k<span class="op">/</span>m,<span class="dv">3</span>))</span>
<span id="cb63-30"><a href="#cb63-30"></a></span>
<span id="cb63-31"><a href="#cb63-31"></a><span class="co">#trace plot</span></span>
<span id="cb63-32"><a href="#cb63-32"></a>index &lt;-<span class="st"> </span>(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>m</span>
<span id="cb63-33"><a href="#cb63-33"></a>y &lt;-<span class="st"> </span>x[index]</span>
<span id="cb63-34"><a href="#cb63-34"></a><span class="kw">plot</span>(index, y, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb63-35"><a href="#cb63-35"></a></span>
<span id="cb63-36"><a href="#cb63-36"></a><span class="co">#QQ plot</span></span>
<span id="cb63-37"><a href="#cb63-37"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">10</span>)</span>
<span id="cb63-38"><a href="#cb63-38"></a>QR &lt;-<span class="st"> </span><span class="kw">tan</span>(pi<span class="op">*</span>(a<span class="dv">-1</span><span class="op">/</span><span class="dv">2</span>)) <span class="co">#deciles of standard cauchy</span></span>
<span id="cb63-39"><a href="#cb63-39"></a>Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(y, a)</span>
<span id="cb63-40"><a href="#cb63-40"></a><span class="kw">qqplot</span>(QR, Q, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;standard cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb63-41"><a href="#cb63-41"></a><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The final rejection probability is close to 40%, which meets the requirements of Markov chain. It can also be seen from the two figures that the random numbers generated by Markov chain are very close to the empirical distribution and the target distribution.</p>
<p><br />
9.8:<br />
In this question, we use the paremeters in paper[40], where <span class="math inline">\(n=16,\alpha=2,\beta=4\)</span> and <span class="math inline">\(f(x|y)\sim B(n,y)\)</span>, <span class="math inline">\(f(y|x)\sim Beta(x+\alpha,n-x+\beta)\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>burn &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb64-6"><a href="#cb64-6"></a></span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="co">#conditional parameters</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>n &lt;-<span class="st"> </span><span class="dv">16</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>alpha &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>beta &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb64-11"><a href="#cb64-11"></a></span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="co">###### generate the chain #####</span></span>
<span id="cb64-13"><a href="#cb64-13"></a>X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb64-15"><a href="#cb64-15"></a>x2 &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb64-16"><a href="#cb64-16"></a>X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb64-17"><a href="#cb64-17"></a>x1 &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb64-18"><a href="#cb64-18"></a>X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, x1 <span class="op">+</span><span class="st"> </span>alpha, n <span class="op">-</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>beta)</span>
<span id="cb64-19"><a href="#cb64-19"></a>}</span>
<span id="cb64-20"><a href="#cb64-20"></a></span>
<span id="cb64-21"><a href="#cb64-21"></a>b &lt;-<span class="st"> </span>burn <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>x &lt;-<span class="st"> </span>X[b<span class="op">:</span>N, ]</span>
<span id="cb64-23"><a href="#cb64-23"></a><span class="kw">plot</span>(x[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb64-24"><a href="#cb64-24"></a><span class="kw">lines</span>(x[,<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb64-25"><a href="#cb64-25"></a><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="kw">c</span>(<span class="kw">expression</span>(X[<span class="dv">1</span>]),<span class="kw">expression</span>(X[<span class="dv">2</span>])),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb64-26"><a href="#cb64-26"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span>
<span id="cb64-27"><a href="#cb64-27"></a><span class="kw">plot</span>(x, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(X[<span class="dv">1</span>]),<span class="dt">ylab=</span><span class="kw">bquote</span>(X[<span class="dv">2</span>]), <span class="dt">ylim=</span><span class="kw">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><br />
Gelman-Rubin method:<br />
(1)9.3:<br />
Target distribution: Cauchy(0, 1)<br />
Proposal distribution: <span class="math inline">\(N(X_t,4)\)</span><br />
The function of Gelman-Rubin method is referred to slides.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co">#calculate G.R statistics</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb65-3"><a href="#cb65-3"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>        psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb65-6"><a href="#cb65-6"></a>        n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb65-7"><a href="#cb65-7"></a>        k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb65-8"><a href="#cb65-8"></a></span>
<span id="cb65-9"><a href="#cb65-9"></a>        psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb65-10"><a href="#cb65-10"></a>        B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb65-11"><a href="#cb65-11"></a>        psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>        W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb65-13"><a href="#cb65-13"></a>        v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb65-14"><a href="#cb65-14"></a>        r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb65-15"><a href="#cb65-15"></a>        <span class="kw">return</span>(r.hat)</span>
<span id="cb65-16"><a href="#cb65-16"></a>}</span>
<span id="cb65-17"><a href="#cb65-17"></a></span>
<span id="cb65-18"><a href="#cb65-18"></a><span class="co">#9.3 MC</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, theta) {</span>
<span id="cb65-20"><a href="#cb65-20"></a><span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb65-21"><a href="#cb65-21"></a>}</span>
<span id="cb65-22"><a href="#cb65-22"></a></span>
<span id="cb65-23"><a href="#cb65-23"></a>cauchy.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb65-24"><a href="#cb65-24"></a>        x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb65-25"><a href="#cb65-25"></a>        x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1 </span>
<span id="cb65-26"><a href="#cb65-26"></a>        u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb65-27"><a href="#cb65-27"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb65-28"><a href="#cb65-28"></a>          xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb65-29"><a href="#cb65-29"></a>          y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt, <span class="dt">sd =</span> sigma)</span>
<span id="cb65-30"><a href="#cb65-30"></a>          num &lt;-<span class="st"> </span><span class="kw">f</span>(y, <span class="dt">theta =</span> <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb65-31"><a href="#cb65-31"></a>          den &lt;-<span class="st"> </span><span class="kw">f</span>(xt, <span class="dt">theta =</span> <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb65-32"><a href="#cb65-32"></a>          <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb65-33"><a href="#cb65-33"></a>              x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb65-34"><a href="#cb65-34"></a>          }</span>
<span id="cb65-35"><a href="#cb65-35"></a>        }</span>
<span id="cb65-36"><a href="#cb65-36"></a>        <span class="kw">return</span>(x)</span>
<span id="cb65-37"><a href="#cb65-37"></a>}</span>
<span id="cb65-38"><a href="#cb65-38"></a>    </span>
<span id="cb65-39"><a href="#cb65-39"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span>      <span class="co">#parameter of proposal distribution</span></span>
<span id="cb65-40"><a href="#cb65-40"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb65-41"><a href="#cb65-41"></a>n &lt;-<span class="st"> </span><span class="dv">18000</span>      <span class="co">#length of chains</span></span>
<span id="cb65-42"><a href="#cb65-42"></a>b &lt;-<span class="st"> </span><span class="dv">2000</span>       <span class="co">#burn-in length</span></span>
<span id="cb65-43"><a href="#cb65-43"></a></span>
<span id="cb65-44"><a href="#cb65-44"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb65-45"><a href="#cb65-45"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb65-46"><a href="#cb65-46"></a></span>
<span id="cb65-47"><a href="#cb65-47"></a><span class="co">#generate the chains</span></span>
<span id="cb65-48"><a href="#cb65-48"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb65-49"><a href="#cb65-49"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb65-50"><a href="#cb65-50"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb65-51"><a href="#cb65-51"></a>    X[i, ] &lt;-<span class="st"> </span><span class="kw">cauchy.chain</span>(sigma, n, x0[i])</span>
<span id="cb65-52"><a href="#cb65-52"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb65-53"><a href="#cb65-53"></a>    psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb65-54"><a href="#cb65-54"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb65-55"><a href="#cb65-55"></a>    psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb65-56"><a href="#cb65-56"></a></span>
<span id="cb65-57"><a href="#cb65-57"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb65-58"><a href="#cb65-58"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb65-59"><a href="#cb65-59"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb65-60"><a href="#cb65-60"></a>    <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi)) </span>
<span id="cb65-61"><a href="#cb65-61"></a></span>
<span id="cb65-62"><a href="#cb65-62"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb65-63"><a href="#cb65-63"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb65-64"><a href="#cb65-64"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb65-65"><a href="#cb65-65"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb65-66"><a href="#cb65-66"></a></span>
<span id="cb65-67"><a href="#cb65-67"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb65-68"><a href="#cb65-68"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The plot of <span class="math inline">\(\hat R\)</span> over time 2001 to 20000 suggests that the chain has approximately converged to the target distribution within approximately 5000 iterations.</p>
<p>(2)9.8:<br />
What we’re generating here is a two-dimensional random variable, but the formula we used to calculate the statistics above is for one-dimensional random variables. Therefore, we want to use a trick here that will allow us to continue to use the formula above.<br />
And the way we came up with it was to take the generated two-dimensional random variables and spell them into one-dimensional random variables, which is “as.vector(t(x))” in the code. So every row of the matrix X that we keep, the first half is the value of X, and the second half is the value of y.<br />
But our code has some problems. It keeps reporting errors and can’t be paused. So here we can only give the code, not the result.</p>
<p>R Codes:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co">#9.8 MC  </span></span>
<span id="cb66-2"><a href="#cb66-2"></a>bb.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {  </span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="co">#generates a Metropolis chain for Normal(0,1)  </span></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="co">#with Normal(X[t], sigma) proposal distribution  </span></span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="co">#and starting value X1  </span></span>
<span id="cb66-6"><a href="#cb66-6"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  </span>
<span id="cb66-7"><a href="#cb66-7"></a>x[<span class="dv">1</span>,] &lt;-<span class="st"> </span>X1   </span>
<span id="cb66-8"><a href="#cb66-8"></a>  </span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {  </span>
<span id="cb66-10"><a href="#cb66-10"></a>x2 &lt;-<span class="st"> </span>x[j<span class="dv">-1</span>, <span class="dv">2</span>]  </span>
<span id="cb66-11"><a href="#cb66-11"></a>x[j, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dt">size =</span><span class="dv">16</span>, <span class="dt">prob =</span> x2)  </span>
<span id="cb66-12"><a href="#cb66-12"></a>x1 &lt;-<span class="st"> </span>x[j, <span class="dv">1</span>]  </span>
<span id="cb66-13"><a href="#cb66-13"></a>x[j, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, <span class="dt">shape1 =</span> x1 <span class="op">+</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">20</span> <span class="op">-</span><span class="st"> </span>x1)  </span>
<span id="cb66-14"><a href="#cb66-14"></a><span class="co">#n=16,alpna=2,beta=4  </span></span>
<span id="cb66-15"><a href="#cb66-15"></a>}  </span>
<span id="cb66-16"><a href="#cb66-16"></a><span class="kw">return</span>(<span class="kw">as.vector</span>(<span class="kw">t</span>(x))) </span>
<span id="cb66-17"><a href="#cb66-17"></a>}</span>
<span id="cb66-18"><a href="#cb66-18"></a>  </span>
<span id="cb66-19"><a href="#cb66-19"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>            </span>
<span id="cb66-20"><a href="#cb66-20"></a><span class="co">#number of chains to generate  </span></span>
<span id="cb66-21"><a href="#cb66-21"></a>N &lt;-<span class="st"> </span><span class="dv">15000</span>        </span>
<span id="cb66-22"><a href="#cb66-22"></a><span class="co">#length of chains  </span></span>
<span id="cb66-23"><a href="#cb66-23"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>         </span>
<span id="cb66-24"><a href="#cb66-24"></a><span class="co">#burn-in length</span></span>
<span id="cb66-25"><a href="#cb66-25"></a>  </span>
<span id="cb66-26"><a href="#cb66-26"></a><span class="co">#choose overdispersed initial values  </span></span>
<span id="cb66-27"><a href="#cb66-27"></a>x0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb66-28"><a href="#cb66-28"></a>  </span>
<span id="cb66-29"><a href="#cb66-29"></a><span class="co">#generate the chains  </span></span>
<span id="cb66-30"><a href="#cb66-30"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)  </span>
<span id="cb66-31"><a href="#cb66-31"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>N)  </span>
<span id="cb66-32"><a href="#cb66-32"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)  </span>
<span id="cb66-33"><a href="#cb66-33"></a>X[i, ] &lt;-<span class="st"> </span><span class="kw">bb.chain</span>(sigma, N, x0[i,])  </span>
<span id="cb66-34"><a href="#cb66-34"></a></span>
<span id="cb66-35"><a href="#cb66-35"></a><span class="co">#compute diagnostic statistics  </span></span>
<span id="cb66-36"><a href="#cb66-36"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))  </span>
<span id="cb66-37"><a href="#cb66-37"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))  </span>
<span id="cb66-38"><a href="#cb66-38"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb66-39"><a href="#cb66-39"></a>  </span>
<span id="cb66-40"><a href="#cb66-40"></a><span class="co">#plot psi for the four chains  </span></span>
<span id="cb66-41"><a href="#cb66-41"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  </span>
<span id="cb66-42"><a href="#cb66-42"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)  </span>
<span id="cb66-43"><a href="#cb66-43"></a><span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="dv">2</span><span class="op">*</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi)) </span>
<span id="cb66-44"><a href="#cb66-44"></a>  </span>
<span id="cb66-45"><a href="#cb66-45"></a><span class="co">#plot the sequence of R-hat statistics  </span></span>
<span id="cb66-46"><a href="#cb66-46"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>N)  </span>
<span id="cb66-47"><a href="#cb66-47"></a><span class="cf">for</span> (l <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="dv">2</span><span class="op">*</span>N)  </span>
<span id="cb66-48"><a href="#cb66-48"></a>rhat[l] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>l])</span>
<span id="cb66-49"><a href="#cb66-49"></a>  </span>
<span id="cb66-50"><a href="#cb66-50"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="dv">2</span><span class="op">*</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)  </span>
<span id="cb66-51"><a href="#cb66-51"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="homework-for-11.18" class="section level2">
<h2>homework for 11.18</h2>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>1.Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R).<br />
2.Suppose <span class="math inline">\(T_1,...,T_n\)</span> i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i&lt;=\tau)+\tau I(T_i&gt;\tau),i=1,...,n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85 Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>11.3:<br />
We can rewrite this formula into: <span class="math display">\[\frac{(-1)^k}{k!2^k}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}\]</span> <span class="math display">\[=(-1)^k||a||^{2k+1}\frac{exp(log(\Gamma(\frac{d+1}{2}))+log(\Gamma(k+\frac{3}{2}))-log(\Gamma(k+\frac{d}{2}+1))}{exp(logk!+klog2+log(2k+1)+log(2k+2))}\]</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>explg &lt;-<span class="st"> </span><span class="cf">function</span>(k,a,d){</span>
<span id="cb67-2"><a href="#cb67-2"></a>  (<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k<span class="op">*</span><span class="kw">dist</span>(a)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">+</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>))<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">+</span>(d<span class="op">/</span><span class="dv">2</span>)))<span class="op">/</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">+</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(<span class="kw">prod</span>(<span class="dv">1</span><span class="op">:</span>k))<span class="op">+</span>k<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span>)))</span>
<span id="cb67-3"><a href="#cb67-3"></a>}</span>
<span id="cb67-4"><a href="#cb67-4"></a></span>
<span id="cb67-5"><a href="#cb67-5"></a>rk &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb67-6"><a href="#cb67-6"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb67-7"><a href="#cb67-7"></a>rd &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb67-8"><a href="#cb67-8"></a>z &lt;-<span class="st"> </span><span class="kw">numeric</span>(rd)</span>
<span id="cb67-9"><a href="#cb67-9"></a>ra &lt;-<span class="st"> </span><span class="kw">rbind</span>(a, z)</span>
<span id="cb67-10"><a href="#cb67-10"></a></span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="kw">cat</span>(<span class="st">&quot;The third term is&quot;</span>,<span class="kw">round</span>(<span class="kw">explg</span>(rk, ra, rd), <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## The third term is -0.09987</code></pre>
<p>when k is small, we can calculate this term precisely.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>rk &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb69-3"><a href="#cb69-3"></a>rd &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb69-4"><a href="#cb69-4"></a>z &lt;-<span class="st"> </span><span class="kw">numeric</span>(rd)</span>
<span id="cb69-5"><a href="#cb69-5"></a>ra &lt;-<span class="st"> </span><span class="kw">rbind</span>(a, z)</span>
<span id="cb69-6"><a href="#cb69-6"></a></span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="kw">cat</span>(<span class="st">&quot;The 200th term is&quot;</span>,<span class="kw">explg</span>(rk, ra, rd))</span></code></pre></div>
<pre><code>## The 200th term is 0</code></pre>
<p>when k is large, we can still calculate this term precisely.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a>rd &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb71-3"><a href="#cb71-3"></a>z &lt;-<span class="st"> </span><span class="kw">numeric</span>(rd)</span>
<span id="cb71-4"><a href="#cb71-4"></a>ra &lt;-<span class="st"> </span><span class="kw">rbind</span>(a, z)</span>
<span id="cb71-5"><a href="#cb71-5"></a></span>
<span id="cb71-6"><a href="#cb71-6"></a>sum &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">400</span>)</span>
<span id="cb71-8"><a href="#cb71-8"></a>  sum &lt;-<span class="st"> </span>sum <span class="op">+</span><span class="st"> </span><span class="kw">explg</span>(i, ra, rd)</span>
<span id="cb71-9"><a href="#cb71-9"></a>  </span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="kw">cat</span>(<span class="st">&quot;The sum is&quot;</span>,<span class="kw">round</span>(sum, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## The sum is -0.43133</code></pre>
<p><br />
11.5:<br />
we can rewrite this equality into:<br />
<span class="math display">\[exp(log(\Gamma(\frac{k}{2}))-log(\Gamma(\frac{k-1}{2}))-log(\sqrt{(k-1)}))\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-\frac{k}{2}}du\]</span> <span class="math display">\[=exp(log(\Gamma(\frac{k+1}{2}))-log(\Gamma(\frac{k}{2}))-log(\sqrt k))\int_0^{c_k}(1+\frac{u^2}{k})^{-\frac{k+1}{2}}du\]</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a,k){</span>
<span id="cb73-2"><a href="#cb73-2"></a>  g1&lt;-<span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>)))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a>  g2&lt;-<span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb73-4"><a href="#cb73-4"></a>  g11 &lt;-<span class="st"> </span><span class="kw">integrate</span>(g1, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</span>
<span id="cb73-5"><a href="#cb73-5"></a>  g22 &lt;-<span class="st"> </span><span class="kw">integrate</span>(g2, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</span>
<span id="cb73-6"><a href="#cb73-6"></a>  <span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="kw">sqrt</span>(k<span class="dv">-1</span>))) <span class="op">*</span><span class="st"> </span>g11 <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="kw">sqrt</span>(k))) <span class="op">*</span><span class="st"> </span>g22</span>
<span id="cb73-7"><a href="#cb73-7"></a>}</span>
<span id="cb73-8"><a href="#cb73-8"></a></span>
<span id="cb73-9"><a href="#cb73-9"></a></span>
<span id="cb73-10"><a href="#cb73-10"></a>r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>)</span>
<span id="cb73-11"><a href="#cb73-11"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb73-12"><a href="#cb73-12"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">17</span>)){</span>
<span id="cb73-13"><a href="#cb73-13"></a>  </span>
<span id="cb73-14"><a href="#cb73-14"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">f</span>(a,k)  <span class="co">#求根必须是只关于a的函数</span></span>
<span id="cb73-15"><a href="#cb73-15"></a>  </span>
<span id="cb73-16"><a href="#cb73-16"></a>  res &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g, <span class="dt">lower =</span> <span class="fl">0.1</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.001</span>)</span>
<span id="cb73-17"><a href="#cb73-17"></a>  r[i] &lt;-<span class="st"> </span>res<span class="op">$</span>root</span>
<span id="cb73-18"><a href="#cb73-18"></a>  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb73-19"><a href="#cb73-19"></a>}</span>
<span id="cb73-20"><a href="#cb73-20"></a></span>
<span id="cb73-21"><a href="#cb73-21"></a>i &lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb73-22"><a href="#cb73-22"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">18</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)){</span>
<span id="cb73-23"><a href="#cb73-23"></a>  </span>
<span id="cb73-24"><a href="#cb73-24"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">f</span>(a,k) </span>
<span id="cb73-25"><a href="#cb73-25"></a>  </span>
<span id="cb73-26"><a href="#cb73-26"></a>  res &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g, <span class="dt">lower =</span> <span class="fl">0.1</span>, <span class="dt">upper =</span> <span class="dv">3</span>)</span>
<span id="cb73-27"><a href="#cb73-27"></a>  r[i] &lt;-<span class="st"> </span>res<span class="op">$</span>root</span>
<span id="cb73-28"><a href="#cb73-28"></a>  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb73-29"><a href="#cb73-29"></a>}</span>
<span id="cb73-30"><a href="#cb73-30"></a></span>
<span id="cb73-31"><a href="#cb73-31"></a>r </span></code></pre></div>
<pre><code>##  [1] 1.492104 1.533559 1.562751 1.584429 1.601169 1.614496 1.625383 1.634409
##  [9] 1.642027 1.648567 1.654175 1.659102 1.663411 1.667293 1.670730 1.673822
## [17] 1.676601 1.679125 1.681493 1.683610 1.685558 1.687356 1.720599 1.729728
## [25] 1.730877</code></pre>
<p>It’s interesting that when we use the same upper=sqrt(k)-0.001, we find the value at ends are not the same sign. After several trials, we choose 3 as the upper for k larger than 18. It’s possible that when k is larger, there exists more than one root.<br />
From our results, we can see that all the roots are between 1.4 and 1.8. And the value of root doesn’t move much as k grow large, which is consistent with the result in 11.4.</p>
<p><br />
E-M algorithm:</p>
<p>complete data: <span class="math inline">\(x=(x^{(1)},y)\)</span><br />
observed data: <span class="math inline">\(x^{(1)},x^{(2)}\)</span><br />
missing data: <span class="math inline">\(y\)</span></p>
<p>Observed data lkelihood:<br />
<span class="math inline">\(L_o(\lambda|x^{(1)},x^{(2)})=\prod_{i=1}^{7}\lambda e^{-\lambda x_i}\prod_{i=1}^3P(X&gt;1)=\lambda^{7}e^{-\lambda\sum_{i=1}^{7}x_i}e^{-3\lambda}\)</span><br />
<span class="math inline">\(l_o(\lambda|x^{(1)},x^{(2)})=7log\lambda-\lambda\sum_{i=1}^{7}x_i-3\lambda\)</span><br />
<span class="math inline">\(\Rightarrow \hat{\lambda}=\frac{7}{\sum_{i=1}^{7}x_i+3}\)</span></p>
<p>Complete data likelihood:<br />
<span class="math inline">\(L_c(\lambda|x^{(1)},y)=\prod_{i=1}^{7}\lambda e^{-\lambda x_i}\prod_{i=1}^3\lambda e^{-\lambda y_i}=\lambda^{10}e^{-\lambda(\sum_{i=1}^{7}x_i+\sum_{i=1}^{3}y_i)}\)</span><br />
<span class="math inline">\(l_o(\lambda|x^{(1)},y)=10log\lambda-\lambda(\sum_{i=1}^{7}x_i+\sum_{i=1}^{3}y_i)\)</span><br />
<span class="math inline">\(\Rightarrow \hat{\lambda}=\frac{10}{\sum_{i=1}^{7}x_i+\sum_{i=1}^{3}y_i}\)</span></p>
<p>E-step:<br />
<span class="math inline">\(\ E_{\hat{\lambda_0}}[l_o(\lambda|x^{(1)},y)|x^{(1)},x^{(2)}]\)</span><br />
<span class="math inline">\(=10log\lambda-\lambda\sum_{i=1}^{7}x_i-\lambda\sum_{i=1}^{3}E[y_i|x^{(1)},x^{(2)}]\)</span><br />
<span class="math inline">\(=10log\lambda-\lambda\sum_{i=1}^{7}x_i-3\lambda E_{\hat{\lambda_0}}[y|x^{(2)}]=10log\lambda-\lambda\sum_{i=1}^{7}x_i-3\lambda\frac{\int_1^{+\infty}\hat{\lambda_0}e^{-\hat{\lambda_0y}}ydy}{\int_1^{+\infty}\hat{\lambda_0}e^{-\hat{\lambda_0y}}dy}\)</span><br />
<span class="math inline">\(=10log\lambda-\lambda\sum_{i=1}^{7}x_i-3\lambda \frac{\hat{\lambda_0}+1}{\hat{\lambda_0}}\)</span></p>
<p>M-step: <span class="math inline">\(\frac{10}{\lambda}-\sum_{i=1}^{7}x_i-3\frac{\hat{\lambda_0}+1}{\hat{\lambda_0}}=0\)</span><br />
<span class="math inline">\(\Rightarrow \hat{\lambda_1}=\frac{10}{\sum_{i=1}^{7}x_i+3\frac{\hat{\lambda_0}+1}{\hat{\lambda_0}}}\)</span></p>
<p>The converged: <span class="math inline">\(\tilde{\lambda}=\frac{7}{\sum_{i=1}^{7}x_i+3}\)</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co">####the observed data MLE</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="kw">library</span>(stats4)</span>
<span id="cb75-3"><a href="#cb75-3"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb75-4"><a href="#cb75-4"></a></span>
<span id="cb75-5"><a href="#cb75-5"></a>mlogL &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">theta=</span><span class="dv">1</span>) {</span>
<span id="cb75-6"><a href="#cb75-6"></a>        <span class="co"># minus log-likelihood</span></span>
<span id="cb75-7"><a href="#cb75-7"></a>        <span class="kw">return</span>(<span class="op">-</span>((<span class="kw">length</span>(y)<span class="op">-</span><span class="dv">3</span>)<span class="op">*</span><span class="kw">log</span>(theta)<span class="op">-</span>theta<span class="op">*</span><span class="kw">sum</span>(y)))</span>
<span id="cb75-8"><a href="#cb75-8"></a>    }</span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a>fit &lt;-<span class="st"> </span><span class="kw">mle</span>(mlogL)</span>
<span id="cb75-11"><a href="#cb75-11"></a><span class="kw">as.numeric</span>(<span class="kw">c</span>(fit<span class="op">@</span>coef,<span class="kw">sqrt</span>(fit<span class="op">@</span>vcov)))</span></code></pre></div>
<pre><code>## [1] 1.0370391 0.3919636</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#max. number of iterations</span></span>
<span id="cb77-3"><a href="#cb77-3"></a>L &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#initial est. for lambdas</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb77-5"><a href="#cb77-5"></a>L.old &lt;-<span class="st"> </span>L <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb77-6"><a href="#cb77-6"></a></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="cf">repeat</span> { </span>
<span id="cb77-8"><a href="#cb77-8"></a>  L &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">/</span>(<span class="kw">sum</span>(y)<span class="op">+</span><span class="dv">3</span><span class="op">/</span>L) <span class="co">#The iterative formula</span></span>
<span id="cb77-9"><a href="#cb77-9"></a>  <span class="cf">if</span>((<span class="kw">abs</span>(L <span class="op">-</span><span class="st"> </span>L.old)<span class="op">/</span>L.old) <span class="op">&lt;</span><span class="st"> </span>tol) {</span>
<span id="cb77-10"><a href="#cb77-10"></a>    <span class="cf">break</span></span>
<span id="cb77-11"><a href="#cb77-11"></a>  }</span>
<span id="cb77-12"><a href="#cb77-12"></a>  L.old &lt;-<span class="st"> </span>L</span>
<span id="cb77-13"><a href="#cb77-13"></a>}</span>
<span id="cb77-14"><a href="#cb77-14"></a>L</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>We can see the results from MLE and E-M algorithm are the same, The EM estimate is exactly the observed data MLE.</p>
</div>
<div id="homework-for-11.25" class="section level2">
<h2>homework for 11.25</h2>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>1.Exercises 1 and 5 (page 204, Advanced R)<br />
2.Exercises 1 and 7 (page 214, Advanced R)</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Page204.1:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>trims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a>x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="kw">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="kw">mean</span>(x, <span class="dt">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.5896808
## 
## [[2]]
## [1] -0.2413601
## 
## [[3]]
## [1] -0.1714624
## 
## [[4]]
## [1] -0.1966193</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">lapply</span>(trims, mean, <span class="dt">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.5896808
## 
## [[2]]
## [1] -0.2413601
## 
## [[3]]
## [1] -0.1714624
## 
## [[4]]
## [1] -0.1966193</code></pre>
<p>In the first lapply(), mean() is applied to trims’ elements. In the second lapply(), the first parameter of mean() is the third parameter of lapply().</p>
<p><br />
Page204.5:<br />
First, we’ll write out the models from the first two exercises (we’ll just use lapply () for the loop here).</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co">####model in 204.3</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb83-3"><a href="#cb83-3"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb83-4"><a href="#cb83-4"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb83-5"><a href="#cb83-5"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb83-6"><a href="#cb83-6"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb83-7"><a href="#cb83-7"></a>)</span>
<span id="cb83-8"><a href="#cb83-8"></a></span>
<span id="cb83-9"><a href="#cb83-9"></a>m1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, <span class="dt">data =</span> mtcars)</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co">###model in 204.4</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb84-3"><a href="#cb84-3"></a>rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb84-4"><a href="#cb84-4"></a>mtcars[rows, ]</span>
<span id="cb84-5"><a href="#cb84-5"></a>})</span>
<span id="cb84-6"><a href="#cb84-6"></a></span>
<span id="cb84-7"><a href="#cb84-7"></a>m2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps , lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp )</span></code></pre></div>
<p>Then apply function rsq to the two models respectively, and extract <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co">###204.5</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span>
<span id="cb85-3"><a href="#cb85-3"></a>r1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(m1, rsq)</span>
<span id="cb85-4"><a href="#cb85-4"></a>r2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(m2, rsq)</span>
<span id="cb85-5"><a href="#cb85-5"></a>r1</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>r2</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7396125
## 
## [[2]]
## [1] 0.5881307
## 
## [[3]]
## [1] 0.7949539
## 
## [[4]]
## [1] 0.6912439
## 
## [[5]]
## [1] 0.7146237
## 
## [[6]]
## [1] 0.7043308
## 
## [[7]]
## [1] 0.758888
## 
## [[8]]
## [1] 0.7260397
## 
## [[9]]
## [1] 0.7736084
## 
## [[10]]
## [1] 0.6327292</code></pre>
<p><br />
Page214.1:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="co">###the standard deviation of every column in a numeric data frame</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb89-4"><a href="#cb89-4"></a>a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rnorm</span>(n,<span class="dv">10</span>,<span class="dv">20</span>), <span class="kw">rexp</span>(n,<span class="dv">2</span>), <span class="kw">rt</span>(n,<span class="dv">6</span>))</span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="kw">round</span>(<span class="kw">vapply</span>(a, sd, <span class="dt">FUN.VALUE=</span><span class="kw">c</span>(<span class="dt">mean=</span><span class="dv">0</span>)), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## rnorm.n..10..20.       rexp.n..2.         rt.n..6. 
##          17.3376           0.3768           1.0753</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="co">###the standard deviation of every numeric column in a mixed data frame</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb91-4"><a href="#cb91-4"></a>b &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rnorm</span>(n,<span class="dv">10</span>,<span class="dv">20</span>), letters[<span class="dv">1</span><span class="op">:</span>n], <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">12</span>)))</span>
<span id="cb91-5"><a href="#cb91-5"></a><span class="kw">round</span>(<span class="kw">vapply</span>(b[<span class="kw">vapply</span>(b, is.numeric, <span class="dt">FUN.VALUE=</span><span class="kw">logical</span>(<span class="dv">1</span>))], sd, <span class="dt">FUN.VALUE=</span><span class="kw">c</span>(<span class="dt">mean=</span><span class="dv">0</span>)), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##             rnorm.n..10..20. rep.c.1..2..3...c.4..4..12.. 
##                      17.3376                       0.8208</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="co"># the inner vapply used to extract numeric column</span></span></code></pre></div>
<p><br />
Page214.7:<br />
There is a function called parsapply() in parllel package for calculation. And the custom function is loaded with the clusterExport() function before using parsapply().</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="kw">library</span>(parallel)</span>
<span id="cb94-2"><a href="#cb94-2"></a>cl.cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>() <span class="co">#Check the number of cores currently available on computer</span></span>
<span id="cb94-3"><a href="#cb94-3"></a>cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(cl.cores) <span class="co">#Use the kernel parallelism just examined</span></span>
<span id="cb94-4"><a href="#cb94-4"></a></span>
<span id="cb94-5"><a href="#cb94-5"></a>boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]</span>
<span id="cb94-6"><a href="#cb94-6"></a>rsquared &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.square</span>
<span id="cb94-7"><a href="#cb94-7"></a>boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</span>
<span id="cb94-8"><a href="#cb94-8"></a>dat &lt;-<span class="st"> </span><span class="kw">boot_df</span>(mtcars)</span>
<span id="cb94-9"><a href="#cb94-9"></a><span class="kw">rsquared</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> dat))</span>
<span id="cb94-10"><a href="#cb94-10"></a>}</span>
<span id="cb94-11"><a href="#cb94-11"></a></span>
<span id="cb94-12"><a href="#cb94-12"></a><span class="co">#Load custom functions into the parallel computing environment</span></span>
<span id="cb94-13"><a href="#cb94-13"></a><span class="kw">clusterExport</span>(cl, <span class="st">&quot;boot_df&quot;</span>)  </span>
<span id="cb94-14"><a href="#cb94-14"></a><span class="kw">clusterExport</span>(cl, <span class="st">&quot;rsquared&quot;</span>)</span>
<span id="cb94-15"><a href="#cb94-15"></a><span class="kw">clusterExport</span>(cl, <span class="st">&quot;boot_lm&quot;</span>)</span>
<span id="cb94-16"><a href="#cb94-16"></a></span>
<span id="cb94-17"><a href="#cb94-17"></a>n &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb94-18"><a href="#cb94-18"></a>a &lt;-<span class="st"> </span><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, boot_lm))</span>
<span id="cb94-19"><a href="#cb94-19"></a>b &lt;-<span class="st"> </span><span class="kw">system.time</span>(<span class="kw">parSapply</span>(<span class="dt">cl =</span> cl, <span class="dv">1</span><span class="op">:</span>n, boot_lm))</span>
<span id="cb94-20"><a href="#cb94-20"></a>a</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 1.21 0.00 1.20</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>b</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.00 0.59</code></pre>
<p>The running time using parallel computing is significantly shorter than sapply().<br />
I can’t implement parvapply(), because there is no function called parvapply() in backage parallel.</p>
</div>
<div id="homework-for-12.02" class="section level2">
<h2>homework for 12.02</h2>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>1.Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).<br />
2.Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
3.Campare the computation time of the two functions with the function “microbenchmark”.<br />
4.Comments your results.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(n=16,\alpha=2,\beta=4\)</span> and <span class="math inline">\(f(x|y)\sim B(n,y)\)</span>, <span class="math inline">\(f(y|x)\sim Beta(x+\alpha,n-x+\beta)\)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co">#####Rcpp function for 9.8</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="co">#####myGibbsC.cpp</span></span>
<span id="cb98-3"><a href="#cb98-3"></a></span>
<span id="cb98-4"><a href="#cb98-4"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb98-5"><a href="#cb98-5"></a>using namespace Rcpp;</span>
<span id="cb98-6"><a href="#cb98-6"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb98-7"><a href="#cb98-7"></a>NumericMatrix <span class="kw">myGibbsC</span>(int N, int b) {</span>
<span id="cb98-8"><a href="#cb98-8"></a>  NumericMatrix <span class="kw">XC</span>(N, <span class="dv">2</span>);</span>
<span id="cb98-9"><a href="#cb98-9"></a>  NumericMatrix <span class="kw">XCN</span>(N<span class="op">-</span>b, <span class="dv">2</span>);</span>
<span id="cb98-10"><a href="#cb98-10"></a>  <span class="kw">XC</span>(<span class="dv">0</span>,<span class="dv">0</span>) =<span class="st"> </span><span class="fl">0.5</span>, <span class="kw">XC</span>(<span class="dv">0</span>,<span class="dv">1</span>) =<span class="st"> </span><span class="fl">0.5</span>;</span>
<span id="cb98-11"><a href="#cb98-11"></a>  <span class="cf">for</span>(int <span class="dt">i =</span> <span class="dv">1</span>; i <span class="op">&lt;</span><span class="st"> </span>N; i<span class="op">++</span>) {</span>
<span id="cb98-12"><a href="#cb98-12"></a>    <span class="kw">XC</span>(i,<span class="dv">0</span>) =<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">16</span>, <span class="kw">XC</span>(i<span class="dv">-1</span>,<span class="dv">1</span>))[<span class="dv">0</span>];</span>
<span id="cb98-13"><a href="#cb98-13"></a>    <span class="kw">XC</span>(i,<span class="dv">1</span>) =<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, <span class="kw">XC</span>(i,<span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">20</span> <span class="op">-</span><span class="st"> </span><span class="kw">XC</span>(i,<span class="dv">0</span>))[<span class="dv">0</span>];</span>
<span id="cb98-14"><a href="#cb98-14"></a>  }</span>
<span id="cb98-15"><a href="#cb98-15"></a>  <span class="cf">for</span>(int <span class="dt">j =</span> <span class="dv">0</span>; j <span class="op">&lt;</span><span class="st"> </span>N<span class="op">-</span>b;j<span class="op">++</span>){</span>
<span id="cb98-16"><a href="#cb98-16"></a>    <span class="kw">XCN</span>(j,<span class="dv">0</span>) =<span class="st"> </span><span class="kw">XC</span>(j<span class="op">+</span>b,<span class="dv">0</span>);</span>
<span id="cb98-17"><a href="#cb98-17"></a>    <span class="kw">XCN</span>(j,<span class="dv">1</span>) =<span class="st"> </span><span class="kw">XC</span>(j<span class="op">+</span>b,<span class="dv">1</span>);</span>
<span id="cb98-18"><a href="#cb98-18"></a>  }</span>
<span id="cb98-19"><a href="#cb98-19"></a>  <span class="kw">return</span>(XCN);</span>
<span id="cb98-20"><a href="#cb98-20"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>dir_cpp &lt;-<span class="st"> &#39;../src/&#39;</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&#39;myGibbsC.cpp&#39;</span>))</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;E:/
## master/StatComp21074/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co">#####Pure R function for 9.8</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="co">#####myGibbsR.R</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>myGibbsR &lt;-<span class="st"> </span><span class="cf">function</span>(N,b){</span>
<span id="cb103-4"><a href="#cb103-4"></a>  XR &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> N, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb103-5"><a href="#cb103-5"></a>  XRN &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> N <span class="op">-</span><span class="st"> </span>b, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb103-6"><a href="#cb103-6"></a>  XR[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb103-7"><a href="#cb103-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb103-8"><a href="#cb103-8"></a>    XR[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">16</span>, XR[i<span class="dv">-1</span>, <span class="dv">2</span>])</span>
<span id="cb103-9"><a href="#cb103-9"></a>    XR[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, XR[i, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">20</span> <span class="op">-</span><span class="st"> </span>XR[i, <span class="dv">1</span>])</span>
<span id="cb103-10"><a href="#cb103-10"></a>  }</span>
<span id="cb103-11"><a href="#cb103-11"></a>  XRN &lt;-<span class="st"> </span>XR[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N, ]</span>
<span id="cb103-12"><a href="#cb103-12"></a>}</span>
<span id="cb103-13"><a href="#cb103-13"></a></span>
<span id="cb103-14"><a href="#cb103-14"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb103-15"><a href="#cb103-15"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb103-16"><a href="#cb103-16"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb103-17"><a href="#cb103-17"></a></span>
<span id="cb103-18"><a href="#cb103-18"></a><span class="co">#Compare the random numbers using the function “qqplot”</span></span>
<span id="cb103-19"><a href="#cb103-19"></a>XR&lt;-<span class="kw">myGibbsR</span>(N,b)</span>
<span id="cb103-20"><a href="#cb103-20"></a>XC&lt;-<span class="kw">myGibbsC</span>(N,b)</span>
<span id="cb103-21"><a href="#cb103-21"></a><span class="kw">qqplot</span>(XR[,<span class="dv">1</span>], XC[,<span class="dv">1</span>], <span class="dt">xlab =</span> <span class="kw">deparse1</span>(<span class="kw">substitute</span>(x1)),<span class="dt">ylab =</span> <span class="kw">deparse1</span>(<span class="kw">substitute</span>(X2)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">qqplot</span>(XR[,<span class="dv">2</span>], XC[,<span class="dv">2</span>], <span class="dt">xlab =</span> <span class="kw">deparse1</span>(<span class="kw">substitute</span>(y1)),<span class="dt">ylab =</span> <span class="kw">deparse1</span>(<span class="kw">substitute</span>(y2)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="co">#Compare the computation time using function “microbenchmark”</span></span>
<span id="cb105-2"><a href="#cb105-2"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">myGibbsR=</span><span class="kw">myGibbsR</span>(N,b),<span class="dt">myGibbsC=</span><span class="kw">myGibbsC</span>(N,b))</span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##       expr       lq   median       uq
## 1 myGibbsR 26.32125 28.51175 30.24790
## 2 myGibbsC  2.02390  2.10260  2.24035</code></pre>
<p>From the qqplot, we can see that the corresponding generated random numbers using two kinds of function are almost similar. But the computation time of pure R function are around 15 times longer than Cpp function. Here, the unit of ts is milliseconds.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
